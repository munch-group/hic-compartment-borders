[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "hic-compartment-borders",
    "section": "",
    "text": "Preface\nThese pages are generated from a Git repository…",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#section",
    "href": "index.html#section",
    "title": "hic-compartment-borders",
    "section": "Section",
    "text": "Section\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Duis sagittis posuere ligula sit amet lacinia. Duis dignissim pellentesque magna, rhoncus congue sapien finibus mollis. Ut eu sem laoreet, vehicula ipsum in, convallis erat. Vestibulum magna sem, blandit pulvinar augue sit amet, auctor malesuada sapien. Nullam faucibus leo eget eros hendrerit, non laoreet ipsum lacinia. Curabitur cursus diam elit, non tempus ante volutpat a. Quisque hendrerit blandit purus non fringilla. Integer sit amet elit viverra ante dapibus semper. Vestibulum viverra rutrum enim, at luctus enim posuere eu. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#section-1",
    "href": "index.html#section-1",
    "title": "hic-compartment-borders",
    "section": "Section",
    "text": "Section\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Duis sagittis posuere ligula sit amet lacinia. Duis dignissim pellentesque magna, rhoncus congue sapien finibus mollis. Ut eu sem laoreet, vehicula ipsum in, convallis erat. Vestibulum magna sem, blandit pulvinar augue sit amet, auctor malesuada sapien. Nullam faucibus leo eget eros hendrerit, non laoreet ipsum lacinia. Curabitur cursus diam elit, non tempus ante volutpat a. Quisque hendrerit blandit purus non fringilla. Integer sit amet elit viverra ante dapibus semper. Vestibulum viverra rutrum enim, at luctus enim posuere eu. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#install",
    "href": "index.html#install",
    "title": "hic-compartment-borders",
    "section": "Install",
    "text": "Install\nconda install -c conda-forge git git-lfs\ngit lfs install",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#configure",
    "href": "index.html#configure",
    "title": "hic-compartment-borders",
    "section": "Configure",
    "text": "Configure\ngit lfs track \"*.h5\"\ngit add .gitattributes ; git commit -m 'Added LFS' ; git push\nFrom now, on all h5 files add added to the repo will go on lfs.\nhttps://docs.github.com/en/repositories/working-with-files/managing-large-files/configuring-git-large-file-storage",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#managing-files",
    "href": "index.html#managing-files",
    "title": "hic-compartment-borders",
    "section": "Managing files",
    "text": "Managing files\n\n\n\n\n\n\nWarning\n\n\n\nManaging files is for the PI only.\n\n\nhttps://docs.github.com/en/repositories/managing-your-repositorys-settings-and-features/managing-repository-settings/managing-git-lfs-objects-in-archives-of-your-repository # Submodules\nSubmodules are useful if you have analysis components that are used across many projects or if results from several past/ongoing projects need to be integrated in a project as a third-party library.\nThe repos can each have their own adjustable workflow as decribed here, that are then easily put together in a larger workflow as described here.\n\n\n\n\n\n\nImportant\n\n\n\nMake sure you install the current version of Git in your environments. The one on the cluster is ancient.\nconda install -c conda-forge git\nI also set these configs for each environment to get nicer/safer commands (commands below assume these are set):\ngit config --global diff.submodule log\ngit config status.submodulesummary 1\ngit config push.recurseSubmodules check",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#tldr",
    "href": "index.html#tldr",
    "title": "hic-compartment-borders",
    "section": "TLDR;",
    "text": "TLDR;\n# clone repository as submodule\ngit submodule add git@github.com:munch-group/${REPO}.git\n\n# initialize it\ngit submodule init ${REPO} # initialize it\n\n# and pull the current state of the submodule repo\ngit submodule update ${REPO}\n\n# track new .gitmodules\ngit add .gitmodules ${REPO} && git commit -m \"Added ${REPO} as submodule\" && git push \n\n# checkout main or some other branch)\ncd ${REPO} && git checkout main && cd .. \n\n# config sensible defaults for diff, status, and push\ngit config --global diff.submodule log\ngit config status.submodulesummary 1\ngit config push.recurseSubmodules check",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#add-a-submodule",
    "href": "index.html#add-a-submodule",
    "title": "hic-compartment-borders",
    "section": "Add a submodule",
    "text": "Add a submodule\nNow, say you have a project repo called “umbrella” that will contain other projects and that you have cloned that:\ngit clone git@github.com:kaspermunch/umbrella.git\nYou want to use an rfmix pipeline in your project. So you clone this repository as submodule:\n\n\nTerminal\n\ngit submodule add git@github.com:munch-group/rfmix.git\n\nand pull the current state of the submodule repo:\n\n\nTerminal\n\ngit submodule init rfmix\ngit submodule update rfmix\n\nThis also generates a .gitmodules configuration file that git uses to keep track of submodules. Commit that the addalong with the submodule:\n\n\nTerminal\n\ngit add .gitmodules rfmix\ngit commit -m 'Added rfmix as submodule'\ngit push\n\nIf you want to work on/change submodule repo you need to check out a branch to work on (main or some other). Always do this. If you decide to make changes later and forgot you did not check out a branch you could loose those changes:\n\n\nTerminal\n\ncd rfmix\ngit checkout main  # (or some other branch)",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#making-changes-to-the-submodule",
    "href": "index.html#making-changes-to-the-submodule",
    "title": "hic-compartment-borders",
    "section": "Making changes to the submodule",
    "text": "Making changes to the submodule\nnow you can then do some work on the tester repo (E.g. change the README.md) and add, commit as usual:\n\n\nTerminal\n\ncd rfmix\n# change README.md\ngit add README.md\ngit commit",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#publishing-submodule-changes-to-github",
    "href": "index.html#publishing-submodule-changes-to-github",
    "title": "hic-compartment-borders",
    "section": "Publishing submodule changes to GitHub",
    "text": "Publishing submodule changes to GitHub\nTo publish your submodule commit to the tester repo on GitHub you run:\n\n\nTerminal\n\ncd rfmix\ngit push",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#getting-submodule-changes-from-github",
    "href": "index.html#getting-submodule-changes-from-github",
    "title": "hic-compartment-borders",
    "section": "Getting submodule changes from GitHub",
    "text": "Getting submodule changes from GitHub\nif you run “git pull” in the umbrella repo, you pull upstream changes to the umbrella repo including the recorded state (commit) of the tester submodule:\n\n\nTerminal\n\ngit pull\n\nbut it does not pull the tester submodule itself. To do that you run pull in the submodule:\n\n\nTerminal\n\ncd rfmix\ngit pull",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#multiple-submodules",
    "href": "index.html#multiple-submodules",
    "title": "hic-compartment-borders",
    "section": "Multiple submodules",
    "text": "Multiple submodules\nYou can have as many submodules as you want. With more submodules, each update command updates all submodules.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "manuscript/index.html",
    "href": "manuscript/index.html",
    "title": "Title of manuscript",
    "section": "",
    "text": "Abstract\nLorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",
    "crumbs": [
      "Manuscript",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Title of manuscript</span>"
    ]
  },
  {
    "objectID": "manuscript/index.html#subsection-with-text-from-notebook",
    "href": "manuscript/index.html#subsection-with-text-from-notebook",
    "title": "Title of manuscript",
    "section": "Subsection (with text from notebook)",
    "text": "Subsection (with text from notebook)\n\n\n\nThe 24 subjects from workplaces in Denmark were interviewed …. blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah\n\n\n\nEuismod lectus ultrices; duis duis ipsum rhoncus. Ipsum vitae primis potenti suscipit per nascetur rutrum lobortis. Suspendisse et maximus elit. In fringilla gravida ornare. Aenean id lectus pulvinar, sagittis felis nec, rutrum risus. Nam vel neque eu arcu blandit fringilla et in quam. Aliquam luctus est sit amet vestibulum eleifend. Phasellus elementum sagittis molestie. Proin tempor lorem arcu, at condimentum purus volutpat eu.",
    "crumbs": [
      "Manuscript",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Title of manuscript</span>"
    ]
  },
  {
    "objectID": "manuscript/index.html#subsection-with-embedded-table-from-notebook",
    "href": "manuscript/index.html#subsection-with-embedded-table-from-notebook",
    "title": "Title of manuscript",
    "section": "Subsection (with embedded table from notebook)",
    "text": "Subsection (with embedded table from notebook)\nThese were selected to represent as many nationalities as possible (Table 8.1). Proin feugiat leo quis ante condimentum, eu ornare mauris feugiat. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Mauris cursus laoreet ex, ignissim bibendum est posuere iaculis. Suspendisse et maximus elit. In fringilla gravida ornare. Aenean id lectus pulvinar, sagittis felis nec, rutrum risus. Nam vel neque eu arcu blandit fringilla et in quam.\n\n\n\n\n\nTable 4.1: People included in the analysis.\n\n\n\n\n\n\n\n\nname\nage\nsex\nposition\nnationality\n\n\n\n\nJulie\n27\nF\nPhDstudent\nDK\n\n\nThomas\n33\nM\nPostdoc\nGB\n\n\nEmilie\n23\nF\nPhDstudent\nCH\n\n\nSofie\n31\nF\nPostdoc\nDK\n\n\nSara\n29\nF\nPostdoc\nUS\n\n\nCecilie\n34\nF\nPostdoc\nDK\n\n\nAnders\n32\nM\nPhDstudent\nUK\n\n\nEmma\n42\nF\nProfessor\nDK\n\n\nCaroline\n31\nF\nPhDstudent\nDK\n\n\nLaura\n30\nF\nPostdoc\nDK\n\n\nMikkel\n33\nM\nPostdoc\nNL\n\n\nJens\n27\nM\nPhDstudent\nDK\n\n\nAndreas\n29\nM\nPhDstudent\nDK\n\n\nJakob\n28\nM\nPhDstudent\nDK\n\n\nMathilde\n61\nF\nProfessor\nDK\n\n\nKatrine\n35\nF\nPostdoc\nDK\n\n\nPoul\n30\nM\nPostdoc\nDK\n\n\nAnna\n26\nF\nPhDstudent\nDK\n\n\nPeter\n42\nM\nProfessor\nGB\n\n\nIda\n53\nF\nPostdoc\nDK\n\n\nFreja\n30\nF\nPostdoc\nDK\n\n\nMaria\n39\nF\nProfessor\nUK\n\n\nAmalie\n29\nF\nPhDstudent\nDK\n\n\nCamilla\n35\nF\nPostdoc\nDK\n\n\n\n\n\n\n\n\n\nAenean id lectus pulvinar, sagittis felis nec, rutrum risus. Nam vel neque eu arcu blandit fringilla et in quam. Aliquam luctus est sit amet vestibulum eleifend. Phasellus elementum sagittis molestie. Proin tempor lorem arcu, at condimentum purus volutpat eu. Fusce et ellentesque ligula. Pellentesque id tellus at erat luctus fringilla. Suspendisse potenti.",
    "crumbs": [
      "Manuscript",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Title of manuscript</span>"
    ]
  },
  {
    "objectID": "manuscript/index.html#subsection-with-math",
    "href": "manuscript/index.html#subsection-with-math",
    "title": "Title of manuscript",
    "section": "Subsection (with math)",
    "text": "Subsection (with math)\nExcepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. In fringilla gravida ornare. Aenean id lectus pulvinar, sagittis felis nec, rutrum risus. Nam vel neque eu arcu blandit fringilla et in quam. This is calculated as \\(\\pi_k = \\prod_{i=1}^K x_i\\). Phasellus elementum sagittis molestie. Proin tempor lorem arcu, at condimentum purus volutpat eu. Fusce et ellentesque ligula. Pellentesque id tellus at erat luctus fringilla. Suspendisse potenti as shown in (Equation 5.1).\n\\[\n\\lambda = \\sum_{k=1}^N \\pi_k\n\\tag{4.1}\\]\nAs shown in Equation 5.2, ac dignissim magna. Vestibulum vitae egestas elit. Proin feugiat leo quis ante condimentum, eu ornare mauris feugiat. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Mauris cursus laoreet ex, ignissim bibendum est posuere iaculis. Suspendisse et maximus elit.\n\\[\ny \\sim \\beta_1 x + \\beta_2\n\\tag{4.2}\\]",
    "crumbs": [
      "Manuscript",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Title of manuscript</span>"
    ]
  },
  {
    "objectID": "manuscript/index.html#subsection-with-code",
    "href": "manuscript/index.html#subsection-with-code",
    "title": "Title of manuscript",
    "section": "Subsection (with code)",
    "text": "Subsection (with code)\n\n# this code is executed but not shown in the output\nx = 5\n\nPulvinar tempus nascetur sollicitudin fringilla sodales. The value of x is 5. Sapien ullamcorper pretium tellus ultricies sodales aliquet. Proin eros iaculis fames mus cubilia praesent cubilia. Nulla quam montes sed varius nullam non. Mi turpis sagittis ornare condimentum consectetur. In Python, we can define a variable like this:\ny = 4\n\nSubsection (bold and italics)\nThis is bold, so is this. This is italics, so is this. This is both, so is this. Pulvinar tempus nascetur sollicitudin fringilla sodales. Urna lorem nisi volutpat; lobortis dapibus auctor mollis. Suscipit conubia neque cras curae vitae curabitur facilisi inceptos ante. Vehicula volutpat nulla nostra inceptos parturient dui purus ipsum ante.\n\n\nSubsubsection\nPulvinar tempus nascetur sollicitudin fringilla sodales. Urna lorem nisi volutpat; lobortis dapibus auctor mollis. Suscipit conubia neque cras curae vitae curabitur facilisi inceptos ante. Phasellus augue inceptos nulla; amet id egestas ad. Enim ad eget nullam fames blandit neque varius mi. Velit pretium est conubia montes gravida. Vehicula volutpat nulla nostra inceptos parturient dui purus ipsum ante.",
    "crumbs": [
      "Manuscript",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Title of manuscript</span>"
    ]
  },
  {
    "objectID": "manuscript/index.html#section-with-embedded-figures-from-notebooks",
    "href": "manuscript/index.html#section-with-embedded-figures-from-notebooks",
    "title": "Title of manuscript",
    "section": "Section (with embedded figures from notebooks)",
    "text": "Section (with embedded figures from notebooks)\nPretium id vestibulum tristique ornare cras. Litora odio mus nullam molestie himenaeos neque lacus bibendum penatibus. Velit porttitor eget massa hac massa feugiat netus ac. Sodales scelerisque imperdiet curae luctus iaculis est vehicula elementum. (Figure 8.4).\n\n\n\n\n\n\n\n\n\nFigure 5.1: Figure legends are defined alongside the figure in the notebook. The figure size in the notebook is determines its size when embedded in a document 4x3 inches.\n\n\n\n\n\n\nAs shown in Figure 8.6, feugiat leo quis ante condimentum, eu ornare mauris feugiat. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Mauris cursus laoreet ex, ignissim bibendum est posuere iaculis. Suspendisse et maximus elit. In fringilla gravida ornare. Aenean id lectus pulvinar, sagittis felis nec, rutrum risus. Nam vel neque eu arcu blandit fringilla et in quam. Aliquam luctus est sit amet vestibulum eleifend.\n\n\n\n\n\n\n\n\n\nFigure 5.2: Figure legends are defined alongside the figure in the notebook. The figure size in the notebook is determines its size when embedded in a document 4x3 inches.",
    "crumbs": [
      "Manuscript",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Title of manuscript</span>"
    ]
  },
  {
    "objectID": "manuscript/index.html#section-with-table-embedded-from-notebook",
    "href": "manuscript/index.html#section-with-table-embedded-from-notebook",
    "title": "Title of manuscript",
    "section": "Section (with table embedded from notebook)",
    "text": "Section (with table embedded from notebook)\nCubilia hendrerit ipsum suspendisse curae curae suspendisse scelerisque semper luctus. Erat turpis dictum bibendum taciti pharetra. Nisi sed vestibulum felis duis; dapibus id. Justo semper felis potenti commodo class. Mauris venenatis purus integer urna cras faucibus. Eu consequat varius massa porttitor nisi. Est fringilla sed senectus ante fames ipsum aenean porta neque, Table 6.1 lists the mean interaction scores by position and nationality.\n\n\n\n\n\nTable 5.1: Mean interaction scores by position and nationality.\n\n\n\n\n\n\n\n\n\n\nposition\nnationality\ninformality\n\n\n\n\n0\nPhDstudent\nCH\n8.678369\n\n\n7\nProfessor\nDK\n9.064115\n\n\n4\nPostdoc\nGB\n9.554955\n\n\n2\nPhDstudent\nUK\n9.557239\n\n\n5\nPostdoc\nNL\n10.006290\n\n\n3\nPostdoc\nDK\n10.068812\n\n\n1\nPhDstudent\nDK\n10.625503\n\n\n8\nProfessor\nGB\n11.017384\n\n\n6\nPostdoc\nUS\n11.531517\n\n\n9\nProfessor\nUK\n12.053566\n\n\n\n\n\n\n\n\n\n\n\nLigula molestie convallis magnis elit tellus volutpat. Hac id in libero nibh inceptos. Malesuada blandit porttitor ad; netus integer tortor. Quis venenatis lorem sit ex hendrerit porta in. Purus praesent felis eget class luctus condimentum finibus quis tincidunt. Nam lectus malesuada primis dapibus consectetur. Quam placerat nam ullamcorper fusce conubia fermentum himenaeos gravida nostra.\n\nDiscussion\nSociosqu iaculis molestie consectetur; pulvinar imperdiet pellentesque sollicitudin erat. Varius mattis neque blandit sodales mauris vestibulum. Iaculis sodales euismod neque risus nostra magna fermentum eleifend. Tempus consequat montes nec quisque urna quam non montes. Accumsan ligula mauris nullam nascetur maximus sodales. Non tellus vel aliquam aenean nulla turpis curabitur potenti. Eleifend luctus mi primis elementum, rhoncus quisque. Aenean semper blandit cursus sapien; eget sem. Posuere ultricies torquent tellus ridiculus enim placerat malesuada tempus.\nSapien ullamcorper pretium tellus ultricies sodales aliquet. Proin eros iaculis fames mus cubilia praesent cubilia. Nulla quam montes sed varius nullam non. Mi turpis sagittis ornare condimentum consectetur. Aenean orci sagittis nibh venenatis natoque bibendum semper vel. Interdum per velit lacus ridiculus augue convallis mollis. Faucibus eget eros aptent; fusce magnis lacinia duis. Justo ad fames laoreet nisl viverra.\n\n\nConclusion\nLaoreet ullamcorper urna et amet nunc faucibus finibus. Eget consequat sed integer bibendum a mollis nisl luctus. Orci leo quisque inceptos imperdiet proin. Pellentesque commodo parturient maecenas eu leo malesuada ullamcorper nulla viverra. Arcu ligula imperdiet quisque finibus in curae et accumsan. Egestas gravida sollicitudin venenatis pellentesque litora leo.\nCras velit donec in a morbi ligula, ultrices at tempor. Auctor lectus in aptent suscipit congue. Urna dui metus risus eleifend odio nisl magna. Nascetur fringilla metus proin vitae in diam. Class tincidunt lorem et dictum quisque arcu euismod. Adipiscing dui interdum aptent fusce pretium pretium. Efficitur imperdiet sem dictumst ultrices id rhoncus. Congue lacus efficitur scelerisque nibh vestibulum.",
    "crumbs": [
      "Manuscript",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Title of manuscript</span>"
    ]
  },
  {
    "objectID": "thesis/index.html",
    "href": "thesis/index.html",
    "title": "Title of my thesis",
    "section": "",
    "text": "Abstract\nLorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",
    "crumbs": [
      "Thesis",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Title of my thesis</span>"
    ]
  },
  {
    "objectID": "thesis/index.html#subsection-with-text-from-notebook",
    "href": "thesis/index.html#subsection-with-text-from-notebook",
    "title": "Title of my thesis",
    "section": "Subsection (with text from notebook)",
    "text": "Subsection (with text from notebook)\n\n\n\nThe 24 subjects from workplaces in Denmark were interviewed …. blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah\n\n\n\nEuismod lectus ultrices; duis duis ipsum rhoncus. Ipsum vitae primis potenti suscipit per nascetur rutrum lobortis. Suspendisse et maximus elit. In fringilla gravida ornare. Aenean id lectus pulvinar, sagittis felis nec, rutrum risus. Nam vel neque eu arcu blandit fringilla et in quam. Aliquam luctus est sit amet vestibulum eleifend. Phasellus elementum sagittis molestie. Proin tempor lorem arcu, at condimentum purus volutpat eu.",
    "crumbs": [
      "Thesis",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Title of my thesis</span>"
    ]
  },
  {
    "objectID": "thesis/index.html#subsection-with-inline-table",
    "href": "thesis/index.html#subsection-with-inline-table",
    "title": "Title of my thesis",
    "section": "Subsection (with inline table)",
    "text": "Subsection (with inline table)\nThe table below does not have analysis data but is used to tabulate something that could also be said with prose (Table 5.1). Proin feugiat leo quis ante condimentum, eu ornare mauris feugiatque eu arcu blandit fringilla et in quam.\n\n\n\nTable 5.1: Four categories of RNA with some summary info.\n\n\n\n\n\n\n\n\n\nType\nDescription\n\n\n\n\ntRNA\nA type of RNA that blah, blah, blah, blah, blah, blah, blah, blah, blah, blah, blah, blah, blah, blah, blah, blah, blah, blah, blah, blah, blah, blah, blah\n\n\nmRNA\nA type of RNA that blah, blah, blah, blah, blah, blah, blah, blah, blah, blah, blah, blah\n\n\npiRNA\nA type of RNA that blah, blah, blah, blah, blah, blah, blah, blah, blah, blah, blah, blah\n\n\nsnoRNA\nA type of RNA that blah, blah, blah, blah, blah, blah, blah, blah, blah, blah, blah, blah",
    "crumbs": [
      "Thesis",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Title of my thesis</span>"
    ]
  },
  {
    "objectID": "thesis/index.html#subsection-with-math",
    "href": "thesis/index.html#subsection-with-math",
    "title": "Title of my thesis",
    "section": "Subsection (with math)",
    "text": "Subsection (with math)\nExcepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. In fringilla gravida ornare. Aenean id lectus pulvinar, sagittis felis nec, rutrum risus. Nam vel neque eu arcu blandit fringilla et in quam. This is calculated as \\(\\pi_k = \\prod_{i=1}^K x_i\\). Phasellus elementum sagittis molestie. Proin tempor lorem arcu, at condimentum purus volutpat eu. Fusce et ellentesque ligula. Pellentesque id tellus at erat luctus fringilla. Suspendisse potenti as shown in (Equation 5.1).\n\\[\n\\lambda = \\sum_{k=1}^N \\pi_k\n\\tag{5.1}\\]\nAs shown in Equation 5.2, ac dignissim magna. Vestibulum vitae egestas elit. Proin feugiat leo quis ante condimentum, eu ornare mauris feugiat. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Mauris cursus laoreet ex, ignissim bibendum est posuere iaculis. Suspendisse et maximus elit.\n\\[\ny \\sim \\beta_1 x + \\beta_2\n\\tag{5.2}\\]",
    "crumbs": [
      "Thesis",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Title of my thesis</span>"
    ]
  },
  {
    "objectID": "thesis/index.html#subsection-with-code",
    "href": "thesis/index.html#subsection-with-code",
    "title": "Title of my thesis",
    "section": "Subsection (with code)",
    "text": "Subsection (with code)\n\n# this code is executed but not shown in the output\nx = 5\n\nPulvinar tempus nascetur sollicitudin fringilla sodales. The value of x is 5. Sapien ullamcorper pretium tellus ultricies sodales aliquet. Proin eros iaculis fames mus cubilia praesent cubilia. Nulla quam montes sed varius nullam non. Mi turpis sagittis ornare condimentum consectetur. In Python, we can define a variable like this:\ny = 4",
    "crumbs": [
      "Thesis",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Title of my thesis</span>"
    ]
  },
  {
    "objectID": "thesis/index.html#subsection-bold-and-italics",
    "href": "thesis/index.html#subsection-bold-and-italics",
    "title": "Title of my thesis",
    "section": "Subsection (bold and italics)",
    "text": "Subsection (bold and italics)\nThis is bold, so is this. This is italics, so is this. This is both, so is this. Pulvinar tempus nascetur sollicitudin fringilla sodales. Urna lorem nisi volutpat; lobortis dapibus auctor mollis. Suscipit conubia neque cras curae vitae curabitur facilisi inceptos ante. Vehicula volutpat nulla nostra inceptos parturient dui purus ipsum ante.\n\nSubsubsection\nPulvinar tempus nascetur sollicitudin fringilla sodales. Urna lorem nisi volutpat; lobortis dapibus auctor mollis. Suscipit conubia neque cras curae vitae curabitur facilisi inceptos ante. Phasellus augue inceptos nulla; amet id egestas ad. Enim ad eget nullam fames blandit neque varius mi. Velit pretium est conubia montes gravida. Vehicula volutpat nulla nostra inceptos parturient dui purus ipsum ante.\n\nSubsubsubsection\nPulvinar tempus nascetur sollicitudin fringilla sodales. Urna lorem nisi volutpat; lobortis dapibus auctor mollis. Suscipit conubia neque cras curae vitae curabitur facilisi inceptos ante. Phasellus augue inceptos nulla; amet id egestas ad. Enim ad eget nullam fames blandit neque varius mi. Velit pretium est conubia montes gravida. Vehicula volutpat nulla nostra inceptos parturient dui purus ipsum ante.",
    "crumbs": [
      "Thesis",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Title of my thesis</span>"
    ]
  },
  {
    "objectID": "thesis/index.html#section-with-embedded-figures-from-notebooks",
    "href": "thesis/index.html#section-with-embedded-figures-from-notebooks",
    "title": "Title of my thesis",
    "section": "Section (with embedded figures from notebooks)",
    "text": "Section (with embedded figures from notebooks)\nPretium id vestibulum tristique ornare cras. Litora odio mus nullam molestie himenaeos neque lacus bibendum penatibus. Velit porttitor eget massa hac massa feugiat netus ac. Sodales scelerisque imperdiet curae luctus iaculis est vehicula elementum. (Figure 8.4).\n\n\n\n\n\n\n\n\n\nFigure 6.1: Figure legends are defined alongside the figure in the notebook. The figure size in the notebook is determines its size when embedded in a document 4x3 inches.\n\n\n\n\n\n\nAs shown in Figure 8.6, feugiat leo quis ante condimentum, eu ornare mauris feugiat. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Mauris cursus laoreet ex, ignissim bibendum est posuere iaculis. Suspendisse et maximus elit. In fringilla gravida ornare. Aenean id lectus pulvinar, sagittis felis nec, rutrum risus. Nam vel neque eu arcu blandit fringilla et in quam. Aliquam luctus est sit amet vestibulum eleifend.\n\n\n\n\n\n\n\n\n\nFigure 6.2: Figure legends are defined alongside the figure in the notebook. The figure size in the notebook is determines its size when embedded in a document 4x3 inches.",
    "crumbs": [
      "Thesis",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Title of my thesis</span>"
    ]
  },
  {
    "objectID": "thesis/index.html#section-with-table-embedded-from-notebook",
    "href": "thesis/index.html#section-with-table-embedded-from-notebook",
    "title": "Title of my thesis",
    "section": "Section (with table embedded from notebook)",
    "text": "Section (with table embedded from notebook)\nCubilia hendrerit ipsum suspendisse curae curae suspendisse scelerisque semper luctus. Erat turpis dictum bibendum taciti pharetra. Nisi sed vestibulum felis duis; dapibus id. Justo semper felis potenti commodo class. Mauris venenatis purus integer urna cras faucibus. Eu consequat varius massa porttitor nisi. Est fringilla sed senectus ante fames ipsum aenean porta neque, Table 6.1 lists the mean interaction scores by position and nationality.\n\n\n\n\n\nTable 6.1: Mean interaction scores by position and nationality.\n\n\n\n\n\n\n\n\n\n\nposition\nnationality\ninformality\n\n\n\n\n0\nPhDstudent\nCH\n8.678369\n\n\n7\nProfessor\nDK\n9.064115\n\n\n4\nPostdoc\nGB\n9.554955\n\n\n2\nPhDstudent\nUK\n9.557239\n\n\n5\nPostdoc\nNL\n10.006290\n\n\n3\nPostdoc\nDK\n10.068812\n\n\n1\nPhDstudent\nDK\n10.625503\n\n\n8\nProfessor\nGB\n11.017384\n\n\n6\nPostdoc\nUS\n11.531517\n\n\n9\nProfessor\nUK\n12.053566\n\n\n\n\n\n\n\n\n\n\n\nLigula molestie convallis magnis elit tellus volutpat. Hac id in libero nibh inceptos. Malesuada blandit porttitor ad; netus integer tortor. Quis venenatis lorem sit ex hendrerit porta in. Purus praesent felis eget class luctus condimentum finibus quis tincidunt. Nam lectus malesuada primis dapibus consectetur. Quam placerat nam ullamcorper fusce conubia fermentum himenaeos gravida nostra.",
    "crumbs": [
      "Thesis",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Title of my thesis</span>"
    ]
  },
  {
    "objectID": "slides/index.html",
    "href": "slides/index.html",
    "title": "Example",
    "section": "",
    "text": "Admixture displacement in each geographical region",
    "crumbs": [
      "Slides",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Example</span>"
    ]
  },
  {
    "objectID": "slides/index.html#admixture-displacement-in-each-geographical-region",
    "href": "slides/index.html#admixture-displacement-in-each-geographical-region",
    "title": "Example",
    "section": "",
    "text": "This is a subtitle\nHere we have some text that may run over several lines of the slide frame, depending on how long it is.\n\nfirst item\n\nA sub item\n\n\nNext, we’ll brief review some theme-specific components.\n\nNote that all of the standard Reveal.js features can be used with this theme, even if we don’t highlight them here.",
    "crumbs": [
      "Slides",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Example</span>"
    ]
  },
  {
    "objectID": "slides/index.html#additional-theme-classes",
    "href": "slides/index.html#additional-theme-classes",
    "title": "Example",
    "section": "Additional theme classes",
    "text": "Additional theme classes\n\nSome extra things you can do with the clean theme\nSpecial classes for emphasis\n\n.alert class for default emphasis, e.g. important note.\n.fg class for custom colour, e.g. important note.\n.bg class for custom background, e.g. important note.\n\nCross-references\n\n.button class provides a Beamer-like button, e.g. Summary",
    "crumbs": [
      "Slides",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Example</span>"
    ]
  },
  {
    "objectID": "slides/index.html#social-norms",
    "href": "slides/index.html#social-norms",
    "title": "Example",
    "section": "Social norms",
    "text": "Social norms\n\nSampling\nWe used a sample size of 24.\nIn Denmark, the workplace interaction is very informal and largely unaffected by seniority and age.\n\n\n\nThe 24 subjects from workplaces in Denmark were interviewed …. blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah",
    "crumbs": [
      "Slides",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Example</span>"
    ]
  },
  {
    "objectID": "slides/index.html#social-norms-1",
    "href": "slides/index.html#social-norms-1",
    "title": "Example",
    "section": "Social norms",
    "text": "Social norms\n\nNeither academic seniority or age affected interaction\n\n\n\n\n\n\n\n\n\nFigure 3.1: Figure legends are defined alongside the figure in the notebook. The figure size in the notebook is determines its size when embedded in a document 4x3 inches.\n\n\n\n\n\n\n\n\n\n\nThe correlation between informality and age was -0.044.",
    "crumbs": [
      "Slides",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Example</span>"
    ]
  },
  {
    "objectID": "slides/index.html#slide-title",
    "href": "slides/index.html#slide-title",
    "title": "Example",
    "section": "Slide title",
    "text": "Slide title\n\n\nEat spaghetti\nDrink wine",
    "crumbs": [
      "Slides",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Example</span>"
    ]
  },
  {
    "objectID": "slides/index.html#slide-title-1",
    "href": "slides/index.html#slide-title-1",
    "title": "Example",
    "section": "Slide title",
    "text": "Slide title\n\n\nLeft column\n\n\nOne\nTwo\nThree",
    "crumbs": [
      "Slides",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Example</span>"
    ]
  },
  {
    "objectID": "slides/index.html#admixture-displacement-in-each-geographical-region-1",
    "href": "slides/index.html#admixture-displacement-in-each-geographical-region-1",
    "title": "Example",
    "section": "Admixture displacement in each geographical region",
    "text": "Admixture displacement in each geographical region\n\n\n\n\n\nThe correlation between informality and age was -0.044.\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 3.2: Figure legends are defined alongside the figure in the notebook. The figure size in the notebook is determines its size when embedded in a document 4x3 inches.",
    "crumbs": [
      "Slides",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Example</span>"
    ]
  },
  {
    "objectID": "slides/index.html#slide-title-2",
    "href": "slides/index.html#slide-title-2",
    "title": "Example",
    "section": "Slide Title",
    "text": "Slide Title\nSlide content\n\n\n\n\nSchumer et al. (2018)",
    "crumbs": [
      "Slides",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Example</span>"
    ]
  },
  {
    "objectID": "notebooks/01_preliminary_bayes.html",
    "href": "notebooks/01_preliminary_bayes.html",
    "title": "Probabilistic Modeling of A/B Compartments from E1",
    "section": "",
    "text": "This model infers A/B chromatin compartment structure from the first eigenvector (E1) of the Hi-C contact matrix using a Bayesian framework.\n\nGoals\n\nReplace hard sign-thresholding of E1 with a probabilistic compartment assignment.\nQuantify uncertainty in compartment calls for each genomic bin.\nAllow for modeling of missing E1 values due to low signal.\n\n\n\nAssumptions\n\nEach bin belongs to one of two latent states: A or B compartment.\nE1 values are generated from Gaussian distributions specific to each compartment.\nPrior belief: A has positive E1 values (μ ≈ 1), B has negative (μ ≈ -1).\nBins are initially treated as independent; spatial structure can be added later. (markovian model)\n\n\n\nThe data\n\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport pymc as pm\nimport arviz as az\n\n%config InlineBackend.figure_format = 'svg'\n\n\n\n\n\n# Your input: csv file with only the E1 columns\nresolution = 100000\n\n\ny = pd.Series(pd.read_csv(\"../data/sperm_e1_100kb_arms.csv\").values.flatten())\n\nx = pd.Series(np.arange(0,y.shape[0])*resolution)\n\ndf = pd.DataFrame({\"start\": x, \"e1\": y})\n\ndf\n\n\n\n\n\n\n\n\nstart\ne1\n\n\n\n\n0\n0\nNaN\n\n\n1\n100000\nNaN\n\n\n2\n200000\nNaN\n\n\n3\n300000\nNaN\n\n\n4\n400000\nNaN\n\n\n...\n...\n...\n\n\n1529\n152900000\n0.527405\n\n\n1530\n153000000\n0.496760\n\n\n1531\n153100000\n0.535679\n\n\n1532\n153200000\n0.520581\n\n\n1533\n153300000\nNaN\n\n\n\n\n1534 rows × 2 columns\n\n\n\n\n# Plot the data as a track (stairs for niceity)\n\nfig, ax = plt.subplots(figsize=(15, 3))\n\n\nx_stair = np.zeros(2*y.shape[0])\ny_stair = np.zeros(2*y.shape[0])\nx_stair[0::2] = x\nx_stair[1::2] = x + resolution\ny_stair[0::2] = y\ny_stair[1::2] = y\n\n\nax.fill_between(x_stair, y_stair, where=(y_stair&lt;0), color=\"tab:blue\", ec='None')\nax.fill_between(x_stair, y_stair, where=(y_stair&gt;0), color=\"tab:red\", ec='None')\nax.set_xlim(0, df[\"start\"].max()+resolution)\nax.set_xlabel(\"Genomic Position (bp)\")\nax.set_ylabel(\"E1\")\nax.set_title(\"E1\");\n\n\n\n\n\n\n\n\n\n# Histogram of distribution of E1 values (A and B)\n\nf, ax = plt.subplots(figsize=(13, 3))\n\n# A compartments\nax.hist(y[y&gt;0], bins=100, color=\"tab:red\", alpha=0.5, label=\"A\", density=True)\n# B compartments\nax.hist(y[y&lt;0], bins=100, color=\"tab:blue\", alpha=0.5, label=\"B\", density=True)\n# Mean values (vline)\nax.axvline(y[y&gt;0].mean(), color=\"tab:red\", linestyle=\"--\", label=\"Mean A\")\nax.axvline(y[y&lt;0].mean(), color=\"tab:blue\", linestyle=\"--\", label=\"Mean B\")\nplt.xlabel(\"E1\")\nplt.ylabel(\"Count\")\nplt.legend(loc='upper left')\nplt.tight_layout()\n\n\n\n\n\n\n\n\n\n\nModel Specification\nBefore specifying the model, we need to layout the model structure.\nThe model is a mixture of two Gaussian distributions, one for each compartment (A and B). Then a latent variable indicates the compartment assignment for each bin. The model. More formally;\n\n\nModel Description\nWe aim to model the A/B chromatin compartments using a probabilistic generative approach, rather than relying on deterministic eigenvector sign thresholding. Each genomic bin is modeled as belonging to one of two latent states (A or B), with corresponding expected E1 values.\n\nNotation\nLet:\n\n\\(y_i\\): Observed E1 value at bin \\(i\\)\n$ z_i {0, 1} $: Latent compartment assignment (0 = B, 1 = A)\n$ _A, _B $: Mean E1 values for compartments A and B\n$ $: Shared standard deviation across bins\n$ p $: Prior probability of a bin belonging to compartment A\n\n\n\nGenerative Model\n\\[\n\\begin{aligned}\n\\mu_A &\\sim \\mathcal{N}(0.5, 0.5) \\\\\n\\mu_B &\\sim \\mathcal{N}(-0.5, 0.5) \\\\\n\\sigma &\\sim \\text{HalfNormal}(1) \\\\\np &\\sim \\text{Beta}(a, b) \\quad \\text{(e.g., } a = 2, b = 2 \\text{ or something bimodal)} \\\\\nz_i &\\sim \\text{Bernoulli}(p) \\\\\n\\mu_i &= z_i \\cdot \\mu_A + (1 - z_i) \\cdot \\mu_B \\\\\ny_i &\\sim \\mathcal{N}(\\mu_i, \\sigma) \\\\\n\\end{aligned}\n\\]\nThis model allows us to infer both the compartment state and the uncertainty of the assignment, especially around boundaries between A and B compartments.\n\n\nThe Priors\n\n\\(\\mu_A\\) and \\(\\mu_B\\): We assume that the mean E1 values for compartments A and B are normally distributed around 0.5 and -0.5, respectively, with a standard deviation of 0.5. This reflects our prior belief about the expected E1 values for each compartment.\n\\(\\sigma\\): The standard deviation is modeled using a half-normal distribution, which ensures that it is always positive. This allows for flexibility in modeling the variability of E1 values within each compartment.\n\\(p\\): The prior probability of a bin belonging to compartment A is modeled using a Beta distribution. This allows us to incorporate prior beliefs about the expected proportion of bins in each compartment. The parameters \\(a\\) and \\(b\\) can be adjusted to reflect different prior beliefs (e.g., bimodal distributions).\n\\(z_i\\): The latent variable indicating the compartment assignment for each bin is modeled using a Bernoulli distribution, with the probability of being in compartment A given by \\(p\\).\n\\(y_i\\): The observed E1 values are modeled as normally distributed around the mean E1 value for the assigned compartment, with a shared standard deviation \\(\\sigma\\). This generative model allows us to infer the compartment assignments and their associated uncertainties based on the observed E1 values, while also accounting for the variability in the data.\n\nLet’s look at a few different options for the Beta distribution. There are 3 main options:\n\nUniform: \\(a = 1, b = 1\\) (no prior preference for A or B)\nBimodal: \\(a = 0.5, b = 0.5\\) (most observations are certain to belong to A or B, but a few observations are hard to categorize—borders)\nUnimodal: \\(a = 2, b = 2\\) (most obsevations are hard to categorize)\n\nHere, they are visualized:\n\n# First, have a look at different Beta distributions for the prior on the latent state (z)\n\nfig, ax = plt.subplots()\n\nparams = [(0.5, 0.5), (2, 2), (1, 1)]\ncolors = [\"tab:blue\", \"tab:orange\", \"tab:green\"]\n\nfor (a, b),col in zip(params, colors):\n    with pm.Model() as model:\n        p = pm.Beta(\"p\", alpha=a, beta=b)\n        prior = pm.sample_prior_predictive(samples=5000)\n        az.plot_kde(prior.prior[\"p\"].values, label=f\"Beta({a}, {b})\", ax=ax, fill_kwargs={\"alpha\": 0.2, \"color\":col})\n\nax.set_title(\"Comparison of Beta priors for p\")\nax.set_xlabel(\"p\")\nax.set_ylabel(\"Density\")\nax.legend()\nplt.show()\n\nSampling: [p]\nSampling: [p]\nSampling: [p]\n\n\n\n\n\n\n\n\n\nI find that the most useful prior is the bimodal one, as we have a strong prior belief that most bins are either A or B, but a few bins are hard to categorize. This is especially useful for the edges of compartments, where the E1 values are close to 0. The unimodal prior is not very useful, as it assumes that most bins are hard to categorize, which is not the case in our data. The uniform prior could be useful as the most uninformative prior —the least biased.\n\nwith pm.Model() as model:\n    # Two means for A and B compartments\n    mu_a = pm.Normal(\"mu_a\", 0.5, 0.2)\n    mu_b = pm.Normal(\"mu_b\", -0.5, 0.2)\n    sigma = pm.HalfNormal(\"sigma\", 0.3)\n\n    # Latent state for each bin: 0 = A, 1 = B\n    p = pm.Beta(\"p\", 0.5, 0.5)  # Prior belief: U-shaped distribution\n    z = pm.Bernoulli(\"z\", p=p, shape=y.shape[0])\n\n    # per-bin expected mean\n    mu = pm.math.switch(z, mu_a, mu_b)\n\n    # Likelihood\n    y_lik = pm.Normal(\"y_lik\", mu=mu, sigma=sigma, observed=y)\n\n    # Sample from the posterior\n    trace = pm.sample(2000, tune=2000, cores=4, chains=4, target_accept=0.90)\n\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/pymc/model/core.py:1311: ImputationWarning: Data in y_lik contains missing values and will be automatically imputed from the sampling distribution.\n  warnings.warn(impute_message, ImputationWarning)\nMultiprocess sampling (4 chains in 4 jobs)\nCompoundStep\n&gt;NUTS: [mu_a, mu_b, sigma, p, y_lik_unobserved]\n&gt;BinaryGibbsMetropolis: [z]\n\n\n\n\n\n\n\n\nSampling 4 chains for 2_000 tune and 2_000 draw iterations (8_000 + 8_000 draws total) took 369 seconds.\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\nThe rhat statistic is larger than 1.01 for some parameters. This indicates problems during sampling. See https://arxiv.org/abs/1903.08008 for details\n\n\n\nwith model:\n    pm.sample_posterior_predictive(trace, extend_inferencedata=True)\n\nSampling: [y_lik_observed]\n\n\n\n\n\n\n\n\n\ntrace.posterior_predictive\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n&lt;xarray.Dataset&gt; Size: 192MB\nDimensions:               (chain: 4, draw: 2000, y_lik_observed_dim_0: 1458,\n                           y_lik_dim_0: 1534)\nCoordinates:\n  * chain                 (chain) int64 32B 0 1 2 3\n  * draw                  (draw) int64 16kB 0 1 2 3 4 ... 1996 1997 1998 1999\n  * y_lik_observed_dim_0  (y_lik_observed_dim_0) int64 12kB 0 1 2 ... 1456 1457\n  * y_lik_dim_0           (y_lik_dim_0) int64 12kB 0 1 2 3 ... 1531 1532 1533\nData variables:\n    y_lik_observed        (chain, draw, y_lik_observed_dim_0) float64 93MB 0....\n    y_lik                 (chain, draw, y_lik_dim_0) float64 98MB -0.166 ... ...\nAttributes:\n    created_at:                 2025-05-16T08:54:59.572880+00:00\n    arviz_version:              0.21.0\n    inference_library:          pymc\n    inference_library_version:  5.22.0xarray.DatasetDimensions:chain: 4draw: 2000y_lik_observed_dim_0: 1458y_lik_dim_0: 1534Coordinates: (4)chain(chain)int640 1 2 3array([0, 1, 2, 3])draw(draw)int640 1 2 3 4 ... 1996 1997 1998 1999array([   0,    1,    2, ..., 1997, 1998, 1999], shape=(2000,))y_lik_observed_dim_0(y_lik_observed_dim_0)int640 1 2 3 4 ... 1454 1455 1456 1457array([   0,    1,    2, ..., 1455, 1456, 1457], shape=(1458,))y_lik_dim_0(y_lik_dim_0)int640 1 2 3 4 ... 1530 1531 1532 1533array([   0,    1,    2, ..., 1531, 1532, 1533], shape=(1534,))Data variables: (2)y_lik_observed(chain, draw, y_lik_observed_dim_0)float640.326 0.265 ... 0.6735 0.4306array([[[ 0.32597699,  0.26499327,  0.68448387, ...,  0.27105034,\n          0.42693202,  0.08641603],\n        [-0.44696565,  0.28904839,  0.32202552, ...,  0.5451186 ,\n         -0.16057651,  0.50117498],\n        [-0.44697376,  0.29620888,  0.5313483 , ...,  0.76320998,\n          0.84007183,  1.22816149],\n        ...,\n        [-0.23617009,  0.20548205,  0.31549808, ...,  0.70899471,\n          0.36636634,  0.84965126],\n        [ 0.89668698,  0.20295504,  0.4583802 , ...,  0.89447314,\n          0.63233309,  0.32967148],\n        [ 0.2607376 ,  0.5296278 , -0.18129868, ...,  0.39076159,\n          0.75138359,  0.32161026]],\n\n       [[-0.12910261,  0.62051616,  0.55751726, ...,  0.92542819,\n          0.62527389,  0.17328815],\n        [ 0.30059316,  0.31601204,  0.77693726, ...,  0.80838257,\n          1.17102033,  0.07688196],\n        [-0.05971453,  0.49052675,  0.43139451, ...,  0.52421194,\n          0.58214843,  0.3966866 ],\n...\n        [-0.67479534,  0.04826125,  0.46114197, ...,  0.51142717,\n          0.56312613,  0.44132212],\n        [ 0.47375738,  0.93464498,  0.18750611, ...,  0.55073132,\n          0.36531253, -0.02257115],\n        [-0.28719009,  0.68687198,  0.23642524, ...,  0.598501  ,\n          0.58950243,  0.26253773]],\n\n       [[ 0.20663941, -0.28995606,  0.3803386 , ...,  1.04294978,\n          0.63639562,  0.48968465],\n        [-0.36396759,  0.58316744,  0.72820474, ...,  0.08117591,\n          0.19663554,  0.33652555],\n        [-0.16564086,  0.45851389,  0.94129162, ...,  0.48208336,\n          0.37406799,  0.76067867],\n        ...,\n        [ 0.22809956, -0.30565946,  0.48986698, ...,  0.43563649,\n          0.2992101 ,  0.59048845],\n        [-0.2422065 ,  0.62703996,  0.61483173, ...,  0.56634181,\n          0.58259419,  0.56800617],\n        [ 0.58493695,  0.53549182,  0.27704206, ...,  0.38144754,\n          0.67353589,  0.43062038]]], shape=(4, 2000, 1458))y_lik(chain, draw, y_lik_dim_0)float64-0.166 -0.1799 ... 0.4306 -0.2179array([[[-0.1660292 , -0.17985673, -0.26023504, ...,  0.42693202,\n          0.08641603, -0.55274145],\n        [-0.21150714, -0.10145756, -0.27068274, ..., -0.16057651,\n          0.50117498, -0.16632172],\n        [-0.23946866, -0.06274425,  0.03023001, ...,  0.84007183,\n          1.22816149, -0.29765152],\n        ...,\n        [-0.19333164,  0.37584196,  0.66743258, ...,  0.36636634,\n          0.84965126,  0.36075526],\n        [-0.36907268,  0.56064802,  0.29293095, ...,  0.63233309,\n          0.32967148,  0.14969938],\n        [-0.29841344,  0.37706629,  0.44598858, ...,  0.75138359,\n          0.32161026, -0.57095993]],\n\n       [[-0.37536438,  0.72487385, -0.05656568, ...,  0.62527389,\n          0.17328815, -0.0094021 ],\n        [-0.182772  ,  0.53364722, -0.12721048, ...,  1.17102033,\n          0.07688196, -0.15622311],\n        [-0.19206444,  0.31739949, -0.18634664, ...,  0.58214843,\n          0.3966866 , -0.24571599],\n...\n        [-0.446102  ,  0.23221743,  0.67383966, ...,  0.56312613,\n          0.44132212, -0.0794165 ],\n        [-0.13924611,  0.63462845,  0.24492581, ...,  0.36531253,\n         -0.02257115,  1.00393186],\n        [-0.33928261,  0.56421171,  0.74095334, ...,  0.58950243,\n          0.26253773,  0.31164947]],\n\n       [[ 0.50580408, -0.25880182, -0.11920766, ...,  0.63639562,\n          0.48968465, -0.412674  ],\n        [ 0.59165075, -0.37815934, -0.28023605, ...,  0.19663554,\n          0.33652555, -0.10827593],\n        [ 0.50343298, -0.06778418, -0.30712047, ...,  0.37406799,\n          0.76067867, -0.39219581],\n        ...,\n        [-0.31580653, -0.46968088,  0.83458198, ...,  0.2992101 ,\n          0.59048845, -0.10737888],\n        [-0.10568669, -0.1568406 ,  0.60176155, ...,  0.58259419,\n          0.56800617, -0.38341503],\n        [-0.40081103, -0.37597784,  0.46971986, ...,  0.67353589,\n          0.43062038, -0.21790337]]], shape=(4, 2000, 1534))Indexes: (4)chainPandasIndexPandasIndex(Index([0, 1, 2, 3], dtype='int64', name='chain'))drawPandasIndexPandasIndex(Index([   0,    1,    2,    3,    4,    5,    6,    7,    8,    9,\n       ...\n       1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999],\n      dtype='int64', name='draw', length=2000))y_lik_observed_dim_0PandasIndexPandasIndex(Index([   0,    1,    2,    3,    4,    5,    6,    7,    8,    9,\n       ...\n       1448, 1449, 1450, 1451, 1452, 1453, 1454, 1455, 1456, 1457],\n      dtype='int64', name='y_lik_observed_dim_0', length=1458))y_lik_dim_0PandasIndexPandasIndex(Index([   0,    1,    2,    3,    4,    5,    6,    7,    8,    9,\n       ...\n       1524, 1525, 1526, 1527, 1528, 1529, 1530, 1531, 1532, 1533],\n      dtype='int64', name='y_lik_dim_0', length=1534))Attributes: (4)created_at :2025-05-16T08:54:59.572880+00:00arviz_version :0.21.0inference_library :pymcinference_library_version :5.22.0\n\n\n\naz.plot_ppc(trace, num_pp_samples=1000);\n\n\n\n\n\n\n\n\n\naz.summary(trace, var_names=['z'], hdi_prob=0.95).round(2)\n\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide\n  (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)\n/home/sojern/miniconda3/envs/pymc/lib/python3.13/site-packages/arviz/stats/diagnostics.py:991: RuntimeWarning: invalid value encountered in scalar divide\n  varsd = varvar / evar / 4\n\n\n\n\n\n\n\n\n\nmean\nsd\nhdi_2.5%\nhdi_97.5%\nmcse_mean\nmcse_sd\ness_bulk\ness_tail\nr_hat\n\n\n\n\nz[0]\n0.33\n0.47\n0.0\n1.0\n0.02\n0.01\n618.0\n618.0\n1.00\n\n\nz[1]\n0.36\n0.48\n0.0\n1.0\n0.02\n0.01\n575.0\n575.0\n1.00\n\n\nz[2]\n0.39\n0.49\n0.0\n1.0\n0.02\n0.00\n571.0\n571.0\n1.00\n\n\nz[3]\n0.37\n0.48\n0.0\n1.0\n0.02\n0.00\n714.0\n714.0\n1.01\n\n\nz[4]\n0.36\n0.48\n0.0\n1.0\n0.02\n0.00\n633.0\n633.0\n1.00\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nz[1529]\n1.00\n0.04\n1.0\n1.0\n0.00\n0.01\n5139.0\n8000.0\n1.00\n\n\nz[1530]\n1.00\n0.04\n1.0\n1.0\n0.00\n0.01\n6962.0\n8000.0\n1.00\n\n\nz[1531]\n1.00\n0.04\n1.0\n1.0\n0.00\n0.01\n4026.0\n8000.0\n1.00\n\n\nz[1532]\n1.00\n0.04\n1.0\n1.0\n0.00\n0.01\n4557.0\n8000.0\n1.00\n\n\nz[1533]\n0.34\n0.47\n0.0\n1.0\n0.02\n0.01\n549.0\n549.0\n1.01\n\n\n\n\n1534 rows × 9 columns\n\n\n\n\np_B = trace.posterior[\"z\"].mean(dim=[\"chain\", \"draw\"]).values\nconfidence = abs(p_B - 0.5) / 0.5\nf,ax = plt.subplots(figsize=(10, 3))\nax.plot(x,confidence, color=\"tab:orange\", alpha=0.6, lw=0.3, label=\"prediction confidence\")\n\n\n\n\n\n\n\n\n\n# Plot the data as a track (stairs for niceity)\n\nfig, ax = plt.subplots(figsize=(20, 3))\n\n# Stairs\nx_stair = np.zeros(2*y.shape[0])\ny_stair = np.zeros(2*y.shape[0])\nx_stair[0::2] = x\nx_stair[1::2] = x + resolution\ny_stair[0::2] = y\ny_stair[1::2] = y\n\nax.fill_between(x_stair, y_stair, where=(y_stair&lt;0), color=\"tab:blue\", ec='None')\nax.fill_between(x_stair, y_stair, where=(y_stair&gt;0), color=\"tab:red\", ec='None')\n\n# Plot the posterior mean\npost_mean_scaled = trace.posterior[\"z\"].mean(dim=[\"chain\", \"draw\"]).values-0.5\npms_stair = np.zeros(2*y.shape[0])\npms_stair[0::2] = post_mean_scaled\npms_stair[1::2] = post_mean_scaled\nax.plot(x_stair,pms_stair, color=\"k\", label=\"posterior mean, centered\")\n\n# Plot the confidence in the compartment call as a curve\nconf_stair = np.zeros(2*y.shape[0])\nconf_stair[0::2] = confidence\nconf_stair[1::2] = confidence\nax.plot(x_stair,conf_stair, color=\"tab:orange\", alpha=0.6, lw=0.7, label=\"abs(p_B-0.5)/0.5 [confidence]\")\n\nax.set_xlim(0, 60_000_000)\nax.set_xlabel(\"Genomic Position (bp)\")\nax.set_ylabel(\"E1\")\nax.set_title(\"E1\")\nax.legend(loc=\"best\");",
    "crumbs": [
      "Notebooks",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Probabilistic Modeling of A/B Compartments from E1</span>"
    ]
  },
  {
    "objectID": "notebooks/02_prep_e1_values.html",
    "href": "notebooks/02_prep_e1_values.html",
    "title": "Preparing the E1 values from the raw HIC data, but mapped to the new reference T2T-MMUv1",
    "section": "",
    "text": "Adapt workflow from hic-spermatogenesis\nThe workflow was adapted to work with NCBI (the assembly is not yet on UCSC)\nUse MultiQC to visualize the dedup and mapping steps\n%%bash \n\nmkdir ../data/multiqc/\n\nfor dir in $(ls ../steps/pairs/); do\n    echo $dir\n    multiqc -i $dir -o ../data/multiqc/ -d ../steps/pairs/$dir \n    echo \"\"\n\ndone\n\nfibroblast\n\n\n\n/// ]8;id=777633;https://multiqc.info\\MultiQC]8;;\\ 🔍 v1.25.1\n\n\n\n     update_config | Report title: fibroblast\n\n     update_config | Prepending directory to sample names\n\n     version_check | MultiQC Version v1.29 now available!\n\n       file_search | Search path: /faststorage/project/hic-spermatogenesis/people/sojern/hic-compartment-borders/steps/pairs/fibroblast\n\n         searching | ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 42/42  42  \n\n         pairtools | Found 7 reports\n\n     write_results | Data        : /faststorage/project/hic-spermatogenesis/people/sojern/hic-compartment-borders/data/multiqc/fibroblast_multiqc_report_data\n\n     write_results | Report      : /faststorage/project/hic-spermatogenesis/people/sojern/hic-compartment-borders/data/multiqc/fibroblast_multiqc_report.html\n\n           multiqc | MultiQC complete\n\n\n\n\n\npachytene_spermatocyte\n\n\n\n/// ]8;id=723026;https://multiqc.info\\MultiQC]8;;\\ 🔍 v1.25.1\n\n\n\n     update_config | Report title: pachytene_spermatocyte\n\n     update_config | Prepending directory to sample names\n\n     version_check | MultiQC Version v1.29 now available!\n\n       file_search | Search path: /faststorage/project/hic-spermatogenesis/people/sojern/hic-compartment-borders/steps/pairs/pachytene_spermatocyte\n\n         searching | ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 36/36  36  \n\n         pairtools | Found 6 reports\n\n     write_results | Data        : /faststorage/project/hic-spermatogenesis/people/sojern/hic-compartment-borders/data/multiqc/pachytene_spermatocyte_multiqc_report_data\n\n     write_results | Report      : /faststorage/project/hic-spermatogenesis/people/sojern/hic-compartment-borders/data/multiqc/pachytene_spermatocyte_multiqc_report.html\n\n           multiqc | MultiQC complete\n\n\n\n\n\nround_spermatid\n\n\n\n/// ]8;id=454410;https://multiqc.info\\MultiQC]8;;\\ 🔍 v1.25.1\n\n\n\n     update_config | Report title: round_spermatid\n\n     update_config | Prepending directory to sample names\n\n     version_check | MultiQC Version v1.29 now available!\n\n       file_search | Search path: /faststorage/project/hic-spermatogenesis/people/sojern/hic-compartment-borders/steps/pairs/round_spermatid\n\n         searching | ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 36/36  sm  \n\n         pairtools | Found 6 reports\n\n     write_results | Data        : /faststorage/project/hic-spermatogenesis/people/sojern/hic-compartment-borders/data/multiqc/round_spermatid_multiqc_report_data\n\n     write_results | Report      : /faststorage/project/hic-spermatogenesis/people/sojern/hic-compartment-borders/data/multiqc/round_spermatid_multiqc_report.html\n\n           multiqc | MultiQC complete\n\n\n\n\n\nsperm\n\n\n\n/// ]8;id=414573;https://multiqc.info\\MultiQC]8;;\\ 🔍 v1.25.1\n\n\n\n     update_config | Report title: sperm\n\n     update_config | Prepending directory to sample names\n\n     version_check | MultiQC Version v1.29 now available!\n\n       file_search | Search path: /faststorage/project/hic-spermatogenesis/people/sojern/hic-compartment-borders/steps/pairs/sperm\n\n         searching | ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 30/30  30  \n\n         pairtools | Found 5 reports\n\n     write_results | Data        : /faststorage/project/hic-spermatogenesis/people/sojern/hic-compartment-borders/data/multiqc/sperm_multiqc_report_data\n\n     write_results | Report      : /faststorage/project/hic-spermatogenesis/people/sojern/hic-compartment-borders/data/multiqc/sperm_multiqc_report.html\n\n           multiqc | MultiQC complete\n\n\n\n\n\nspermatogonia\n\n\n\n/// ]8;id=139413;https://multiqc.info\\MultiQC]8;;\\ 🔍 v1.25.1\n\n\n\n     update_config | Report title: spermatogonia\n\n     update_config | Prepending directory to sample names\n\n     version_check | MultiQC Version v1.29 now available!\n\n       file_search | Search path: /faststorage/project/hic-spermatogenesis/people/sojern/hic-compartment-borders/steps/pairs/spermatogonia\n\n         searching | ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 42/42  42  \n\n         pairtools | Found 7 reports\n\n     write_results | Data        : /faststorage/project/hic-spermatogenesis/people/sojern/hic-compartment-borders/data/multiqc/spermatogonia_multiqc_report_data\n\n     write_results | Report      : /faststorage/project/hic-spermatogenesis/people/sojern/hic-compartment-borders/data/multiqc/spermatogonia_multiqc_report.html\n\n           multiqc | MultiQC complete",
    "crumbs": [
      "Notebooks",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Preparing the E1 values from the raw HIC data, but mapped to the new reference T2T-MMUv1</span>"
    ]
  },
  {
    "objectID": "notebooks/02_prep_e1_values.html#rename-chromosomes-from-accessions-to-chromosomes",
    "href": "notebooks/02_prep_e1_values.html#rename-chromosomes-from-accessions-to-chromosomes",
    "title": "Preparing the E1 values from the raw HIC data, but mapped to the new reference T2T-MMUv1",
    "section": "Rename chromosomes from accessions to chromosomes",
    "text": "Rename chromosomes from accessions to chromosomes\nUse the assembly information file from NCBI\n\nimport cooler\nimport pandas as pd\nimport glob\n\n%config InlineBackend.figure_format = 'svg'\n\n\n\n\nmclrs = glob.glob(\"../steps/cool/*/*.merged.mcool\")\nclrs = [f\"{mcl}::{res}\" for mcl in mclrs for res in cooler.fileops.list_coolers(mcl)]\n\n# Locate the assembly report\nreport = \"../steps/ref/T2T-MMU8v1.0/assembly_report.txt\"\n\nrep = pd.read_csv(report, sep=\"\\t\")\nlength = rep[[\"Sequence-Length\",\"Sequence-Name\"]]\nrep_dict = rep.set_index(\"GenBank-Accn\")[\"Sequence-Name\"].to_dict()\ninv_dict = rep.set_index(\"Sequence-Name\")[\"GenBank-Accn\"].to_dict()\n\n\nfor clr in clrs:\n    tmp_clr = cooler.Cooler(clr)\n    cooler.rename_chroms(tmp_clr, rep_dict)",
    "crumbs": [
      "Notebooks",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Preparing the E1 values from the raw HIC data, but mapped to the new reference T2T-MMUv1</span>"
    ]
  },
  {
    "objectID": "notebooks/02_prep_e1_values.html#calculate-the-gc-content",
    "href": "notebooks/02_prep_e1_values.html#calculate-the-gc-content",
    "title": "Preparing the E1 values from the raw HIC data, but mapped to the new reference T2T-MMUv1",
    "section": "Calculate the GC content",
    "text": "Calculate the GC content\nof the binned versions of the assembly (according to resolutions in mcool).\nI will try to use the CLI to make quick work of it.\nIt is used as the phasing track for the eigendecomposition.\n\n%%bash \n\nREF=../steps/ref/T2T-MMU8v1.0/T2T-MMU8v1.0.renamed.fa\n\n#for res in 1000 5000 10000 50000 100000; do\nfor res in 50000; do\n    BINS=../data/bins/t2tbins.${res}.tsv\n    GC_OUT=../data/bins/gc.${res}.tsv\n    cooltools genome gc $BINS $REF &gt; $GC_OUT\ndone",
    "crumbs": [
      "Notebooks",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Preparing the E1 values from the raw HIC data, but mapped to the new reference T2T-MMUv1</span>"
    ]
  },
  {
    "objectID": "notebooks/02_prep_e1_values.html#infer-the-centromeres",
    "href": "notebooks/02_prep_e1_values.html#infer-the-centromeres",
    "title": "Preparing the E1 values from the raw HIC data, but mapped to the new reference T2T-MMUv1",
    "section": "Infer the centromeres",
    "text": "Infer the centromeres\nI found a T2T-MMU8v1repeatMasker.out.gz file and placed it ../steps/ref/T2T-MMU8v1/, then extracted information about longest stretches of satellite repeats.\n\n%%bash \n\n# Navigate\ncd ../steps/ref/T2T-MMU8v1.0\n\n# Download repeatmasker output \nwget https://hgdownload.soe.ucsc.edu/hubs/GCA/049/350/105/GCA_049350105.1/GCA_049350105.1.repeatMasker.out.gz .\n\n# Find all the satellite repeats in the assembly\nzcat GCA_049350105.1.repeatMasker.out.gz | \\\nawk 'NR &gt; 3 && $11 ~ /[Ss]atellite/ { print $5, $6-1, $7, $10 }' OFS='\\t' &gt; satellite_repeats.bed\n\n# Find the satellite repeats on chrX\nzcat GCA_049350105.1.repeatMasker.out.gz | \\\nawk 'NR &gt; 3 && $5 == \"CM111679.1\" && $11 ~ /[Ss]atellite/ { print $5, $6-1, $7, $10 }' OFS=\"\\t\" &gt; chrX_satellites.bed\n\n# Merge the satellite repeats to find the centromere\nbedtools sort -i chrX_satellites.bed | \\\nbedtools merge -d 20000 -c 4 -o distinct &gt; chrX_centromere.bed\n\n# Find the largest satellite repeat\nawk '{ print $0, $3 - $2 }' chrX_centromere.bed | sort -k5,5nr | head -n1",
    "crumbs": [
      "Notebooks",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Preparing the E1 values from the raw HIC data, but mapped to the new reference T2T-MMUv1</span>"
    ]
  },
  {
    "objectID": "notebooks/02_prep_e1_values.html#plot-the-satellites-along-the-genome",
    "href": "notebooks/02_prep_e1_values.html#plot-the-satellites-along-the-genome",
    "title": "Preparing the E1 values from the raw HIC data, but mapped to the new reference T2T-MMUv1",
    "section": "Plot the satellites along the genome",
    "text": "Plot the satellites along the genome\n\nimport pandas as pd\n\nsatellites = pd.read_csv(\"../steps/ref/T2T-MMU8v1.0/chrX_centromere.bed\", sep=\"\\t\",names=['chrom', 'start', 'end', 'type'])\n\nsatellites = satellites.assign(length = satellites['end'] - satellites['start'])\n\n\nimport matplotlib.pyplot as plt\nimport numpy as np\nfrom matplotlib.patches import Rectangle\n\ndef plot_intervals(intervals, **kwargs):\n    f, ax = plt.subplots(figsize=(10, 1), sharex=True)\n    for start, end in zip(intervals['start'], intervals['end']):\n        rect = Rectangle((start, 0.1), width=end-start, height=0.9, color='tab:red', linewidth=0, **kwargs)\n        ax.add_patch(rect)\n    ax.spines[:].set_visible(False)\n    ax.spines['bottom'].set_visible(True)\n\n    ax.set_yticks([])\n    ticks = np.linspace(0, intervals['end'].max(), num=15)\n    ax.set_xticks(ticks) \n    ax.set_xticklabels([f'{int(t/1e6)} Mbp' for t in ticks])\n    f.tight_layout()\n\n\nplot_intervals(satellites, lw=0.3, alpha=1)\n\nlargest = satellites.loc[satellites['length'].idxmax()]\nprint(largest)\n\nchrom          CM111679.1\nstart            57984683\nend              69396537\ntype      ALR/Alpha,HSAT4\nlength           11411854\nName: 8, dtype: object\n\n\n\n\n\n\n\n\n\n\nfrom bioframe import make_viewframe\n\nX_length = rep.query('`Sequence-Name` == \"chrX\"')['Sequence-Length'].values[0]\n\n\nview_T2T_MMU8v1_X_chromarms = make_viewframe([('chrX', 0, largest['start'], \"small_arm\"), \n               ('chrX', largest['start'], largest['end'], 'centromere'),\n               ('chrX', largest['end'], X_length, 'large_arm')])\n\nview_T2T_MMU8v1_X_chromarms.to_csv(\"../data/view_T2T_MMU8v1_X_chromarms.tsv\",  index=False, header=False, sep='\\t')",
    "crumbs": [
      "Notebooks",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Preparing the E1 values from the raw HIC data, but mapped to the new reference T2T-MMUv1</span>"
    ]
  },
  {
    "objectID": "notebooks/02_prep_e1_values.html#do-the-eigendecomposition",
    "href": "notebooks/02_prep_e1_values.html#do-the-eigendecomposition",
    "title": "Preparing the E1 values from the raw HIC data, but mapped to the new reference T2T-MMUv1",
    "section": "Do the eigendecomposition",
    "text": "Do the eigendecomposition\n\n%%bash \n\n# Find multires coolers\nMCOOLS=../steps/cool/*/*.merged.mcool\n\n# Define the viewframe\nVIEW=../data/view_T2T_MMU8v1_X_chromarms.tsv\n\nfor MCOOL in $MCOOLS; do\n    # Get the tissue name\n    TISSUE=$(basename $MCOOL .merged.mcool)\n    echo $TISSUE\n    for res in 1000 5000 10000 50000 100000; do\n        COOLER=$MCOOL::resolutions/$res\n        GC_BINS=../data/bins/gc.${res}.tsv\n        EIGS_OUT=../data/eigs/$TISSUE.eigs.$res\n\n        echo -ne ' -' $res OK\n        cooltools eigs-cis -o $EIGS_OUT --view $VIEW --phasing-track $GC_BINS --n-eigs 3 $COOLER\n\n    done\n    echo \"\"\ndone\n\necho All done\n\nfibroblast\n - 1000 OK - 5000 OK - 10000 OK - 50000 OK - 100000 OK\npachytene_spermatocyte\n - 1000 OK - 5000 OK - 10000 OK - 50000 OK - 100000 OK\nround_spermatid\n - 1000 OK - 5000 OK - 10000 OK - 50000 OK - 100000 OK\nspermatogonia\n - 1000 OK - 5000 OK - 10000 OK - 50000 OK - 100000 OK\nsperm\n - 1000 OK - 5000 OK - 10000 OK - 50000 OK - 100000 OK\nAll done",
    "crumbs": [
      "Notebooks",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Preparing the E1 values from the raw HIC data, but mapped to the new reference T2T-MMUv1</span>"
    ]
  },
  {
    "objectID": "notebooks/02_prep_e1_values.html#check-the-results-by-eye",
    "href": "notebooks/02_prep_e1_values.html#check-the-results-by-eye",
    "title": "Preparing the E1 values from the raw HIC data, but mapped to the new reference T2T-MMUv1",
    "section": "Check the results by eye",
    "text": "Check the results by eye\n\nDefine the eigenvectors\n\nimport pandas as pd\nfrom glob import glob\nimport os\n\neigfiles = glob(\"../data/eigs/*vecs.tsv\")\neignames = [os.path.basename(eig).split('.cis')[0] for eig in eigfiles]\neignames\n\ndf_eig = pd.DataFrame({\n    'path': eigfiles,\n    'tissue': [eigname.split('.eigs.')[0] for eigname in eignames],\n    'resolution': [eigname.split('.eigs.')[1] for eigname in eignames]\n})\n\n\n\nsperm_1000 = pd.read_csv(df_eig.query('tissue == \"sperm\" and resolution == \"1000\"')['path'].values[0], sep=\"\\t\", header=0)\n\ndisplay(sperm_1000.head())\n\nsperm_dict = {\n    res: pd.read_csv(df_eig.query('tissue == \"sperm\" and resolution == @res')['path'].values[0], sep=\"\\t\", header=0) for res in df_eig['resolution'].unique()\n}\n\nfib_dict = {\n    res: pd.read_csv(df_eig.query('tissue == \"fibroblast\" and resolution == @res')['path'].values[0], sep=\"\\t\", header=0) for res in df_eig['resolution'].unique()\n}\n\nprint(sperm_dict['1000'].head())\n\n\n\n\n\n\n\n\nchrom\nstart\nend\nweight\nE1\nE2\nE3\n\n\n\n\n0\nchrX\n0\n1000\nNaN\nNaN\nNaN\nNaN\n\n\n1\nchrX\n1000\n2000\nNaN\nNaN\nNaN\nNaN\n\n\n2\nchrX\n2000\n3000\nNaN\nNaN\nNaN\nNaN\n\n\n3\nchrX\n3000\n4000\nNaN\nNaN\nNaN\nNaN\n\n\n4\nchrX\n4000\n5000\nNaN\nNaN\nNaN\nNaN\n\n\n\n\n\n\n\n  chrom  start   end  weight  E1  E2  E3\n0  chrX      0  1000     NaN NaN NaN NaN\n1  chrX   1000  2000     NaN NaN NaN NaN\n2  chrX   2000  3000     NaN NaN NaN NaN\n3  chrX   3000  4000     NaN NaN NaN NaN\n4  chrX   4000  5000     NaN NaN NaN NaN\n\n\n\nimport matplotlib.pyplot as plt\nimport numpy as np\n\n# Plot the E1 tracks saved in the sperm_dict\n\ndef plot_eigenvectors(eigenvectors, title=None):\n    fig, ax = plt.subplots(figsize=(10, 2))\n\n    x = eigenvectors['start']\n    y = eigenvectors['E1']\n\n    ax.fill_between(x, y, where = y&lt;0, color='tab:blue', lw=1, ec='None')\n    ax.fill_between(x, y, where = y&gt;0, color='tab:red', lw=1, ec='None') \n    ax.set_title(title)\n    ax.set_ylabel('E1')\n    ax.set_xlim(x.min(), x.max())\n    ax.set_ylim(-1,1)\n    ax.set_xlabel('Genomic Position (Mbp)')\n    ticks = np.linspace(0, x.max(), num=10)\n    ax.set_xticks(ticks)\n    ax.set_xticklabels([f'{int(t/1e6)} Mbp' for t in ticks])\n    ax.spines[:].set_visible(False)\n    ax.spines['bottom'].set_visible(True)\n    fig.tight_layout()\n\n\n#res = '100000'\n#plot_eigenvectors(sperm_dict[res], title=f'Sperm E1 at {int(int(res)/1000)}kb resolution')\n\n\n  \nfor res in ['1000', '5000', '10000', '50000', '100000']:\n    plot_eigenvectors(sperm_dict[res], title=f'Sperm E1 at {int(int(res)/1000)}kb resolution')\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfor res in ['1000', '5000', '10000', '50000', '100000']:\n    plot_eigenvectors(fib_dict[res], title=f'Fibroblast E1 at {int(int(res)/1000)}kb resolution')\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIt looks like the 1kb resolution E1 does not reflect A/B-compartmentalization, but only the variance between the three partitions in the viewframe.\n\nI don’t understand that. The partitioning should eliminate the variance between the three partitions, so this could mean that\n\nthere is not much variance within the partitions at this resolution\nthe viewframe is too large\n\nThere are a lot of missing values in the 1kb resolution weight and E1, possibly because cooler found that too few contacts were observed to include the bins. That results in a practically unusable E1 track.\n\ndf = pd.read_csv(\"../data/eigs/fibroblast.eigs.1000.cis.vecs.tsv\", sep=\"\\t\", header=0)\n\ndf.isna().sum()\n\nchrom         0\nstart         0\nend           0\nweight    25734\nE1        25735\nE2        25735\nE3        25735\ndtype: int64",
    "crumbs": [
      "Notebooks",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Preparing the E1 values from the raw HIC data, but mapped to the new reference T2T-MMUv1</span>"
    ]
  },
  {
    "objectID": "master_workflow.html",
    "href": "master_workflow.html",
    "title": "GWF workflow",
    "section": "",
    "text": "Imports and utility functions\nr”“”\nExample workflow using mapping between intput and output of each target. It is made to show all the ways information may be passed through an workflow.\n““”\nimport os\nfrom pathlib import Path\nfrom gwf import Workflow, AnonymousTarget\nfrom gwf.workflow import collect\nimport glob\nInstantiate the workflow with the name of the project folder:\n# instantiate the workflow\ngwf = Workflow(defaults={'account': 'your-project-folder-name'})\nUtility functions:\n# utility function\ndef modify_path(path, **kwargs):\n    \"\"\"\n    Utility function for modifying file paths substituting\n    the directory (dir), base name (base), or file suffix (suffix).\n    \"\"\"\n    for key in ['dir', 'base', 'suffix']:\n        kwargs.setdefault(key, None)\n    assert len(kwargs) == 3\n\n    par, name = os.path.split(path)\n    name_no_suffix, suf = os.path.splitext(name)\n    if type(kwargs['suffix']) is str:\n        suf = kwargs['suffix']\n    if kwargs['dir'] is not None:\n        par = kwargs['dir']\n    if kwargs['base'] is not None:\n        name_no_suffix = kwargs['base']\n\n    new_path = os.path.join(par, name_no_suffix + suf)\n    if type(kwargs['suffix']) is tuple:\n        assert len(kwargs['suffix']) == 2\n        new_path, nsubs = re.subn(r'{}$'.format(kwargs['suffix'][0]), kwargs['suffix'][1], new_path)\n        assert nsubs == 1, nsubs\n    return new_path",
    "crumbs": [
      "Workflows",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>GWF workflow</span>"
    ]
  },
  {
    "objectID": "master_workflow.html#template-functions",
    "href": "master_workflow.html#template-functions",
    "title": "GWF workflow",
    "section": "Template functions:",
    "text": "Template functions:\n\n# task template function\ndef uppercase_names(raw_path): \n    \"\"\"\n    Formats names to uppercase.\n    \"\"\"\n    # dir for files produces by task\n    output_dir = 'steps/upper_cased'\n    # path of output file\n    uppercased_path = modify_path(raw_path, dir=output_dir, suffix='_uppercased.txt')\n\n    # input specification\n    inputs = [raw_path]\n    # output specification mapping a label to each file\n    outputs = {'uppercased_path': uppercased_path}\n    # resource specification\n    options = {'memory': '8g', 'walltime': '00:10:00'} \n\n    # tmporary output file path\n    tmp_uppercased_path = modify_path(raw_path, dir='/tmp')\n\n    # commands to run in task (bash script)\n    # we write to a tmp file and move that to the output directory \n    # only if the command succeds (the && takes care of that)\n    spec = f\"\"\"\n    mkdir -p {output_dir}\n    cat {raw_path} | tr [:lower:] [:upper:] &gt; {tmp_uppercased_path} &&\n        mv {tmp_uppercased_path} {uppercased_path}\n    \"\"\"\n    # return target\n    return AnonymousTarget(inputs=inputs, outputs=outputs, options=options, spec=spec)\n\n\n# task template function\ndef divide_names(uppercased_path, me=None):\n    \"\"\"\n    Splits names into two files. One with my name and one with other names.\n    \"\"\"\n    # uppercased version of the me argument\n    uppercased_me = me.upper()\n\n    # dir for files produces by task\n    output_dir = 'steps/filtered_names'\n    # path of output file with names matching me\n    filt_me_path = modify_path(uppercased_path, dir=output_dir, suffix=f'_{me}.txt')\n    # path of output file with other names\n    filt_other_path = modify_path(uppercased_path, dir=output_dir, suffix=f'_not_{me}.txt')\n\n    # input specification\n    inputs = [uppercased_path]\n    # output specification mapping a label to each file\n    outputs = {'filt_me_path': filt_me_path, 'filt_other_path': filt_other_path}\n    # resource specification\n    options = {'memory': '8g', 'walltime': '00:10:00'} \n\n    # tmporary output file paths\n    tmp_filt_me_path = modify_path(filt_me_path, dir='/tmp')\n    tmp_filt_other_path = modify_path(filt_other_path, dir='/tmp')\n\n    # commands to run in task (bash script)\n    # we write to tmp files and move them to the output directory \n    # only if the command succeds (the && takes care of that)\n    spec = f\"\"\"\n    mkdir -p {output_dir}    \n    grep {uppercased_me} {uppercased_path} &gt; {tmp_filt_me_path} &&  \n        grep -v {uppercased_me} {uppercased_path} &gt; {tmp_filt_other_path} &&  \n        mv {tmp_filt_me_path} {filt_me_path} &&  \n        mv {tmp_filt_other_path} {filt_other_path}\n    \"\"\"\n    # return target\n    return AnonymousTarget(inputs=inputs, outputs=outputs, options=options, spec=spec)\n\n\n# task template function\ndef unique_names(filt_me_path, filt_other_path): \n    \"\"\"\n    Extracts unique names from a file.\n    \"\"\"\n    # dir for files produces by task\n    output_dir = 'steps/unique_names'\n    # path of output file with unique names matching me\n    uniq_me_path = modify_path(filt_me_path, dir=output_dir, suffix='_unique.txt')\n    # path of output file with unique other names\n    uniq_other_path = modify_path(filt_other_path, dir=output_dir, suffix='_unique.txt')\n\n    # input specification\n    inputs = [filt_me_path, filt_other_path]\n    # output specification mapping a label to each file\n    outputs = {'unique_me_path': uniq_me_path, 'unique_other_path': uniq_other_path}\n    # resource specification\n    options = {'memory': '8g', 'walltime': '00:10:00'} \n\n    # tmporary output file paths\n    tmp_uniq_me_path = modify_path(uniq_me_path, dir='/tmp')\n    tmp_uniq_other_path = modify_path(uniq_other_path, dir='/tmp')\n\n    # commands to run in task (bash script)\n    # we write to tmp files and move them to the output directory \n    # only if the command succeds (the && takes care of that)\n    spec = f\"\"\"\n    mkdir -p {output_dir}    \n    sort {filt_me_path} | uniq &gt; {tmp_uniq_me_path} && \n        sort {filt_other_path} | uniq &gt; {tmp_uniq_other_path} && \n        mv {tmp_uniq_me_path} {uniq_me_path} && \n        mv {tmp_uniq_other_path} {uniq_other_path}\n    \"\"\"\n    # return target\n    return AnonymousTarget(inputs=inputs, outputs=outputs, options=options, spec=spec)\n\n\n# task template function\ndef merge_names(paths, output_path): \n    \"\"\"\n    Merges names from many files.\n    \"\"\"\n    # dir for files produces by task\n    output_dir = modify_path(output_path, base='', suffix='')\n\n    # input specification\n    inputs = [paths]\n    # output specification mapping a label to the file\n    outputs = {'path': output_path}\n\n    # tmporary output file path\n    tmp_output_path =  modify_path(output_path, dir='/tmp')\n\n    # resource specification\n    options = {'memory': '8g', 'walltime': '00:10:00'} \n\n    # commands to run in task (bash script)\n    # we write to tmp files and move them to the output directory \n    # only if the command succeds (the && takes care of that)\n    spec = f\"\"\"\n    mkdir -p {output_dir}\n    cat {' '.join(paths)} &gt; {tmp_output_path} && \n        mv {tmp_output_path} {output_path}\n    \"\"\"\n    # return target\n    return AnonymousTarget(inputs=inputs, outputs=outputs, options=options, spec=spec)\n\n# task template function\ndef run_notebook(path, dependencies, memory='8g', walltime='00:10:00', cores=1):    \n    \"\"\"\n    Executes a notebook inplace and saves the output.\n    \"\"\"\n    # path of output sentinel file\n    sentinel = modify_path(path, base=f'.{str(Path(path).name)}', suffix='.sentinel')\n    # sentinel = path.parent / f'.{path.name}'\n\n    # input specification\n    inputs = [path] + dependencies\n    # output specification mapping a label to each file\n    outputs = {'sentinel': sentinel}\n    # resource specification\n    options = {'memory': memory, 'walltime': walltime, 'cores': cores} \n\n    # commands to run in task (bash script)\n    spec = f\"\"\"\n    jupyter nbconvert --to notebook --execute --inplace {path} && touch {sentinel}\n    \"\"\"\n    # return target\n    return AnonymousTarget(inputs=inputs, outputs=outputs, options=options, spec=spec)",
    "crumbs": [
      "Workflows",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>GWF workflow</span>"
    ]
  },
  {
    "objectID": "master_workflow.html#workflow",
    "href": "master_workflow.html#workflow",
    "title": "GWF workflow",
    "section": "Workflow:",
    "text": "Workflow:\n\n# instantiate the workflow\ngwf = Workflow(defaults={'account': 'your-project-folder-name'})\n\n# input files for workflow\ninput_file_names = ['data/input_file1.txt', 'data/input_file2.txt']\n\n# workflow parameter\nmyname = 'Kasper'\n\n# run an uppercase_names task for each input file\nuppercase_names_targets = gwf.map(uppercase_names, input_file_names)\n\n# run an divide_names task for each output file from uppercase_names\nfilter_names_targets = gwf.map(divide_names, uppercase_names_targets.outputs, extra=dict(me=myname))\n\n# run an unique_names task for each output file from divide_names\nunique_names_targets = gwf.map(unique_names, filter_names_targets.outputs)\n\n# collect the outputs labelled 'unique_me_path' from all the outputs of unique_names \ncollected_outputs = collect(unique_names_targets.outputs, ['unique_me_path'])\n\n# create a single task to merge all those files into one\nmerge_me_target = gwf.target_from_template(\n    'merge_not_me_name_files',\n    merge_names(collected_outputs['unique_me_paths'], \"results/merged_me_names.txt\")\n    )\n\n# collect the outputs labelled 'unique_other_path' from all the outputs of unique_names \ncollected_outputs = collect(unique_names_targets.outputs, ['unique_other_path'])\n\n# create a single task to merge all those files into one\nmerge_other_target = gwf.target_from_template(\n    'merge_me_name_files',\n    merge_names(collected_outputs['unique_other_paths'], \"results/merged_not_me_names.txt\")\n    )\n\n# make notebooks depend on all output files from workflow\nnotebook_dependencies = []\nfor x in gwf.targets.values():\n    outputs = x.outputs\n    if type(outputs) is dict:\n        for o in outputs.values():\n            notebook_dependencies.append(o)\n    elif type(outputs) is list:\n        notebook_dependencies.extend(outputs)\n\n#  run notebooks in sorted order nb01_, nb02_, ...\nfor path in glob.glob('notebooks/*.ipynb'):\n    target = gwf.target_from_template(\n        os.path.basename(path), run_notebook(path, notebook_dependencies))\n    # make notebooks depend on all previous notebooks\n    notebook_dependencies.append(target.outputs['sentinel'])",
    "crumbs": [
      "Workflows",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>GWF workflow</span>"
    ]
  },
  {
    "objectID": "workflow.html",
    "href": "workflow.html",
    "title": "master_workflow",
    "section": "",
    "text": "from gwf import * import os import subprocess import os.path as op import pandas as pd from cooler.fileops import list_coolers from pprintpp import pprint as pp\n\n\ngwf workflow for the full pipeline from downloading raw reads to compartmentalization analysis. We are using bwa mem for mapping.\nHow to run: conda activate hic gwf -f master_workflow.py status\nWorkflow: 1a bwa_index : Index the reference genome with bwa index 1b sam_index : Index the fasta again with samtools faidx 1c download_reads : Download raw reads from SRA sra-downloader with SRR IDs (paired-end reads) 2 bwa_map : Map reads (PE) to the reference with bwa mem 3 pair_sort : Pair the merged alignments from mate-pair sequencing with pairtools parse, then sort with pairtools sort 4 dedup : Deduplicate the sorted pairs with pairtools dedup 5 make_pairs_cool : Create a .cool file from the deduplicated pairs with cooler cload pairs\n\n\n\nCreate a workflow object gwf = Workflow(defaults={‘nodes’: 1, ‘queue’:“normal”, ‘account’:“hic-spermatogenesis”})\n\n\n\n\n\nTemplates\n\n\ndef download_index_reference(name, refdir): ““” Download the reference genome from NCBI, and index it for bwa ““” out_dir = op.join(refdir, name) inputs = [] outputs = [f”{out_dir}/index/bwa/{name}.fa”, f”{out_dir}/index/bwa/{name}.fa.amb”, f”{out_dir}/index/bwa/{name}.fa.ann”, f”{out_dir}/index/bwa/{name}.fa.bwt”, f”{out_dir}/index/bwa/{name}.fa.pac”, f”{out_dir}/index/bwa/{name}.fa.sa”, f”{out_dir}/assembly_report.txt”, f”{out_dir}/{name}.fa.sizes”, f”{out_dir}/{name}.fa.fai”, f”{out_dir}/{name}.gaps.bed”, ] options = { ‘memory’: ‘16g’, ‘walltime’: ‘01:00:00’, ‘cores’: 8, } spec = f”“” source $(conda info –base)/etc/profile.d/conda.sh conda activate hic genomepy plugin enable bwa &&\ngenomepy install {name} –provider ncbi –genomes_dir {refdir} –threads 8 ““” return AnonymousTarget(inputs=inputs, outputs=outputs, options=options, spec=spec)\ndef download_reads(sra_downloader, srr_id, read_dir): “““Download raw reads from SRA”“” inputs = [sra_downloader] outputs = [f”{read_dir}/{srr_id}_1.fastq.gz”, f”{read_dir}/{srr_id}2.fastq.gz”, f”{read_dir}/dl{srr_id}.done”] options = {‘cores’:16, ‘memory’: “4g”, ‘walltime’:“06:00:00”} spec = f”“” singularity run {sra_downloader} {srr_id} –save-dir {read_dir} –cores 16 &&\ntouch {read_dir}/dl_{srr_id}.done ““” return AnonymousTarget(inputs=inputs, outputs=outputs, options=options, spec=spec)\ndef bwa_index(ref_genome): “““Template for indexing the reference genome with bwa”“” inputs = [ref_genome] outputs = [f”{ref_genome}.amb”, f”{ref_genome}.ann”, f”{ref_genome}.bwt”, f”{ref_genome}.pac”, f”{ref_genome}.sa”] options = {‘cores’:1, ‘memory’: “8g”, ‘walltime’:“02:00:00”} spec = f’’’ source $(conda info –base)/etc/profile.d/conda.sh conda activate hic bwa index -p {ref_genome} -a bwtsw {ref_genome} ’’’ return AnonymousTarget(inputs=inputs, outputs=outputs, options=options, spec=spec)\ndef sam_index(ref_genome): “““Creating a fasta index. bwa mem also needs a fasta index generated by samtools”“” inputs = [ref_genome] outputs = [f”{ref_genome}.fai”] options = {‘cores’:1, ‘memory’:“1g”, ‘walltime’:“00:20:00”} spec=f”“” source $(conda info –base)/etc/profile.d/conda.sh conda activate hic samtools faidx {ref_genome} ““” return AnonymousTarget(inputs=inputs, outputs=outputs, options=options, spec=spec)\ndef bwa_map(ref_genome, mate_1, mate_2, download_ok, out_bam): ““” Template for mapping reads to a reference genome using bwa and samtools. NB! Here, we map the mates together, as bwa states it is no problem for Hi-C reads. ““” threads = 32 inputs = [f”{ref_genome}.amb”, f”{ref_genome}.ann”, f”{ref_genome}.bwt”, f”{ref_genome}.pac”, f”{ref_genome}.sa”, #f”{ref_genome}.fai”, mate_1, mate_2, download_ok] outputs = [out_bam] options = {‘cores’:threads, ‘memory’: “32g”, ‘walltime’:“24:00:00”} spec = f”“” source $(conda info –base)/etc/profile.d/conda.sh conda activate hic bwa mem -t {threads} -SP {ref_genome} {mate_1} {mate_2} &gt; {out_bam} ““” return AnonymousTarget(inputs=inputs, outputs=outputs, options=options, spec=spec)\nUpdated version uses –walks-policy 5unique in stead of mask def pair_sort_alignments(chromsizes, bam_merged, sorted_pairs): “““Convert the paired-end alignments to .pairs with pairtools parse, then sort”“” inputs = [bam_merged] outputs = [f”{bam_merged}_parsed.stats”, sorted_pairs] options = {‘cores’:32, ‘memory’:“16g”, ‘walltime’:“10:00:00”} spec=f”“” source $(conda info –base)/etc/profile.d/conda.sh conda activate hic pairtools parse\n-c {chromsizes}\n–drop-sam –drop-seq\n–output-stats {bam_merged}_parsed.stats\n–add-columns mapq\n–assembly rheMac10\n–walks-policy 5unique\n{bam_merged} |\npairtools sort -o {sorted_pairs} ““” return AnonymousTarget(inputs=inputs, outputs=outputs, options=options, spec=spec)\ndef dedup(sorted_pairs, chromsizes): “““Deduplicate the sorted pairs with pairtools dedup”“” pairs_prefix = sorted_pairs.split(“.sorted”)[0] inputs = [sorted_pairs] outputs = [f”{pairs_prefix}.nodups.pairs.gz”, f”{pairs_prefix}.unmapped.pairs.gz”, f”{pairs_prefix}.dups.pairs.gz”, f”{pairs_prefix}.dedup.stats”, f”{pairs_prefix}.dedup.done”] options = {‘cores’:12, ‘memory’: “4g”, ‘walltime’: “03:30:00”} spec = f”“” source $(conda info –base)/etc/profile.d/conda.sh conda activate hic pairtools dedup\n–max-mismatch 3\n–mark-dups\n–chunksize 100000\n–chrom-subset {chromsizes}\n–output {pairs_prefix}.nodups.pairs.gz\n–output-unmapped {pairs_prefix}.unmapped.pairs.gz\n–output-stats {pairs_prefix}.dedup.stats\n–output-dups {pairs_prefix}.dups.pairs.gz\n{sorted_pairs} &&\ntouch {pairs_prefix}.dedup.done ““” return AnonymousTarget(inputs=inputs, outputs=outputs, options=options, spec=spec)\nUpdated version uses pairtools select to filter out low quality reads def make_pairs_cool(chromsizes, pairs, cool_out): “““Create coolers from pairs with cooler cload pairs”“” base = os.path.basename(pairs).split(“.pairs.gz”)[0] inputs = [pairs] outputs = [cool_out] options = {‘cores’:1, ‘memory’:“8g”, ‘walltime’:“06:30:00”} spec = f”“” source $(conda info –base)/etc/profile.d/conda.sh conda activate hic pairtools select “(mapq1&gt;=30) and (mapq2&gt;=30)” {pairs} |\ncooler cload pairs\n-c1 2 -p1 3 -c2 4 -p2 5\n–assembly ‘T2T-MMU8v1’\n–chunksize 200000\n{chromsizes}:1000\n-\n{cool_out} ““” return AnonymousTarget(inputs=inputs, outputs=outputs, options=options, spec=spec)\ndef merge_zoomify_balance(cooler_list, merged, mcool): “““Merge a given list of coolers with cooler merge and then zoomify the merged cooler with cooler zoomify”“” cooler_list_unix_str = ” “.join(cooler_list) inputs = [cooler_list] outputs = [merged, mcool] options = {‘cores’:16, ‘memory’:”32g”, ‘walltime’:“08:00:00”} spec = f”“” source $(conda info –base)/etc/profile.d/conda.sh conda activate hic cooler merge -c 50000000 {merged} {cooler_list_unix_str} &&\ncooler zoomify –nproc 16\n–resolutions 1000,5000,10000,50000,100000\n–balance\n–balance-args ‘–nproc 16’\n-o {mcool}\n{merged} ““” return AnonymousTarget(inputs=inputs, outputs=outputs, options=options, spec=spec)\nDRAFT: Not implemented as a target yet def balance_cooler_cis(cool_in, cool_out): “““Balance a cooler with cooler balance”“” mcool = cool_in.split(“::”)[0] inputs = [mcool] outputs = [cool_out] options = {‘cores’:8, ‘memory’:“32g”, ‘walltime’:“03:00:00”} spec = f”“” source $(conda info –base)/etc/profile.d/conda.sh conda activate hic cooler balance -p 32 –cis-only –name cis_weights {cool_in} &&\ntouch {cool_out} ““” return AnonymousTarget(inputs=inputs, outputs=outputs, options=options, spec=spec)\n\n\nSet up the folder structure for the workflow # ###############################################\n# Define our working dir main_dir = op.dirname(file) msc_dir = op.join(main_dir, “../hic-spermatogenesis/”)\nDefine the reads directory (download reads here) reads_dir = op.join(“steps/macaque_raw/downloaded/”)\nCheck to find SRA-downloader, else pull from docker sra_downloader = “steps/sra-downloader.sif”\nif not op.exists(sra_downloader): command = [“singularity”, “pull”, sra_downloader, “docker://wwydmanski/sra-downloader”] try: result = subprocess.run(command, check=True, capture_output=True, text=True) print(result.stdout) print(result.stderr) except subprocess.CalledProcessError as e: print(e.stdout) print(e.stderr)\nDefine subdirs for tissue type, strip_whitespace and make lowercase sra_runtable = pd.read_csv(“data/SraRunTable.txt”) reads_subdirs = set(sra_runtable[“source_name”])\nMake a dict mapping the tissue type [‘source_name’] to the SRR IDs [‘Run’] tissue_dict = {tissue: sra_runtable[sra_runtable[“source_name”]==tissue][“Run”].tolist() for tissue in reads_subdirs}\nDefine the output dirs for files bam_dir = op.join(main_dir,“steps/bamfiles”) pair_dir = op.join(main_dir, “steps/pairs”)\ncool_dir = op.join(main_dir, “steps/cool”)\n\n\n\n\n\n\n\nTargets\n\n\nDownload the reference genome ref_name = “T2T-MMU8v1.0” ref_dir = op.join(main_dir, “steps/ref”)\nT0 = gwf.target_from_template( f”install_T2T_MMU8V1”, download_index_reference(ref_name, ref_dir) )\nref_genome = T0.outputs[0] ref_dir = op.join(ref_dir, ref_name) ## Update ref_dir chromsizes = op.join(ref_dir, f”{ref_name}.fa.sizes”)\n\n\n\nIndex the reference genome\nT1a = gwf.target_from_template(f”bwa_index_{os.path.basename(ref_genome).split(‘.’)[0]}“, bwa_index(ref_genome=ref_genome)) T1b = gwf.target_from_template(f”sam_index_{os.path.basename(ref_genome).split(‘.’)[0]}“, sam_index(ref_genome=ref_genome))\nT5out is a dict to store the cool files for each tissue type to be merged in the end T5out = {}\nT1c target for each ID in the SRA runtable for id in sra_runtable[“Run”]:\n# Do some stuff before downloading the reads\n# Get the tissue type for the ID, and assign a subdirectory for the reads\nsub_dir = None\nfor cell_type, ids in tissue_dict.items():\n    if id in ids:\n        sub_dir = cell_type.lower().replace(\" \", \"_\")\n        break\nif sub_dir is None:\n    raise ValueError(f\"ID {id} not found in any tissue type\")\n\nfastq_dir = op.join(reads_dir, sub_dir)\n\n# Create subdirs if they don't exist\nif not op.exists(fastq_dir):\n    os.makedirs(fastq_dir)\n\n# T1c: Download SRA ID\nT1c = gwf.target_from_template(f\"dl_{id}\",\n                              download_reads(\n                                    sra_downloader = sra_downloader,\n                                    srr_id = id,\n                                    read_dir = fastq_dir\n                                ))\n\n\n# T2: Map the reads to the reference genome\nbam_wdir = op.join(bam_dir, sub_dir)\nout_bam = op.join(bam_wdir, f\"{id}.bam\")\n\nif not op.exists(bam_wdir):\n    os.makedirs(bam_wdir)\n\nT2 = gwf.target_from_template(f\"bwa_map_{id}\", \n                              bwa_map(ref_genome=ref_genome, \n                                      mate_1=T1c.outputs[0], mate_2=T1c.outputs[1], \n                                      download_ok=T1c.outputs[2],\n                                      out_bam=out_bam))\n\n# T3: pair and sort the alignments\npair_subdir = op.join(pair_dir, sub_dir)\nsorted_pairs = op.join(pair_subdir, f\"{id}.sorted.pairs.gz\")\n\nif not op.exists(pair_subdir):\n    os.makedirs(pair_subdir)\n\nT3 = gwf.target_from_template(f\"parse_{id}\",\n                                pair_sort_alignments(chromsizes=chromsizes, \n                                                     bam_merged=T2.outputs[0], \n                                                     sorted_pairs=sorted_pairs))\n\n# T4: Deduplicate the sorted pairs\n# Dedup dir is the same as pair dir\n# NB we are using the reduced chromsizes file (only 'real' chromosomes)\nT4 = gwf.target_from_template(f\"dedup_{id}\",\n                                dedup(sorted_pairs=T3.outputs[1],\n                                        chromsizes=chromsizes))\n\n# T5: Create a .cool file from the deduplicated pairs\ncool_subdir = op.join(cool_dir, sub_dir)\n\nif not op.exists(cool_subdir):\n    os.makedirs(cool_subdir)\n\nT4outpairs = [x for x in T4.outputs if x.endswith(\".pairs.gz\")]\nif sub_dir not in T5out:\n    T5out[sub_dir] = []\n\n\n\nfor T4out in T4outpairs:\n    # Filter to be removed if we want to\n    # Only make a cool file of the 'nodups' pairs\n    if 'nodups' not in T4out:\n        continue\n\n    cool_name = f\"{id}\"\n    cool_file = os.path.join(cool_subdir, f\"{cool_name}.1000.cool\")\n\n    T5 = gwf.target_from_template(f\"coolify_{cool_name}\",\n                                    make_pairs_cool(chromsizes, pairs=T4out, cool_out=cool_file))\n    T5out[sub_dir].append(T5.outputs[0])\n    \nMerge the coolers for each tissue type (group) T6out = {} for subdir,cool_list in T5out.items(): T6out[subdir] = gwf.target_from_template(f”merge_zoom_balance_{subdir}“, merge_zoomify_balance(cooler_list=cool_list, merged=op.join(cool_dir, subdir, f”{subdir}.merged.cool”), mcool=op.join(cool_dir, subdir, f”{subdir}.merged.mcool”))) pp(T6out[subdir].inputs[0])",
    "crumbs": [
      "Workflows",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>master_workflow</span>"
    ]
  },
  {
    "objectID": "reports/example.html",
    "href": "reports/example.html",
    "title": "Markdown in Quarto",
    "section": "",
    "text": "Including BibTex references\nThere are many ways to manage BibTex references. In ReadCube Papers, you just right-click to select Copy...&gt;BibTex entry and paste it into your BibTex file (I also have a script that formats your entire Papers library for BibTex with meaningful labels).\nYou can render citations in different ways to accommodate their sentence. Skov et al. reported strong selection on the human X chromosome (2023). Lineages in small populations have shorter coalescence times (see Nielsen and Slatkin 2016, chap. 1). The Neanderthal genome has been sequenced (Prüfer et al. 2012). The X chromosome is subject to recurrent sweeps (Nam et al. 2015; Dutheil et al. 2015). Following Munch et al. (2014), we blah blah…",
    "crumbs": [
      "Reports",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Markdown in Quarto</span>"
    ]
  },
  {
    "objectID": "reports/example.html#illustrations",
    "href": "reports/example.html#illustrations",
    "title": "Markdown in Quarto",
    "section": "Illustrations",
    "text": "Illustrations\nYou can see an elephant in Figure 8.1.\n\n\n\n\n\n\nFigure 8.1: Some caption for an illustration showing an elephant\n\n\n\nElephants are big (Figure 8.2):\n\n\n\n\n\n\nFigure 8.2\n\n\n\nThere are two elephants in Figure 8.3. The elephants in Figure 8.3 (a) and Figure 8.3 (b) look similar.\n\n\n\n\n\n\n\n\n\n\n\n(a)\n\n\n\n\n\n\n\n\n\n\n\n(b)\n\n\n\n\n\n\n\nFigure 8.3: Some caption you wrote for an illustration of two elephants.",
    "crumbs": [
      "Reports",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Markdown in Quarto</span>"
    ]
  },
  {
    "objectID": "reports/example.html#asides",
    "href": "reports/example.html#asides",
    "title": "Markdown in Quarto",
    "section": "Asides",
    "text": "Asides\nIf you like, you can make comments in the margin without footnote a reference.",
    "crumbs": [
      "Reports",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Markdown in Quarto</span>"
    ]
  },
  {
    "objectID": "reports/example.html#plot-included-from-notebook",
    "href": "reports/example.html#plot-included-from-notebook",
    "title": "Markdown in Quarto",
    "section": "Plot included from notebook",
    "text": "Plot included from notebook\nSee plot Figure 8.4 below.\n\n\n\n\n\n\n\n\n\nFigure 8.4: Figure legends are defined alongside the figure in the notebook. The figure size in the notebook is determines its size when embedded in a document 4x3 inches.\n\n\n\n\n\n\nOr this really wide plot below (Figure 8.5).\n\n\n\n\n\n\n\n\n\n\nFigure 8.5: Figure legends are defined alongside the figure in the notebook. The figure size in the notebook is determines its size when embedded in a document 4x3 inches.",
    "crumbs": [
      "Reports",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Markdown in Quarto</span>"
    ]
  },
  {
    "objectID": "reports/example.html#text-included-from-notebook",
    "href": "reports/example.html#text-included-from-notebook",
    "title": "Markdown in Quarto",
    "section": "Text included from notebook",
    "text": "Text included from notebook\n\n\n\nThe 24 subjects from workplaces in Denmark were interviewed …. blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah",
    "crumbs": [
      "Reports",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Markdown in Quarto</span>"
    ]
  },
  {
    "objectID": "reports/example.html#table-included-from-notebook",
    "href": "reports/example.html#table-included-from-notebook",
    "title": "Markdown in Quarto",
    "section": "Table included from notebook",
    "text": "Table included from notebook\nThese were selected to represent as many nationalities as possible (Table 8.1).\nyou can also allow the table to be wider\n\n\n\n\n\nTable 8.1: People included in the analysis.\n\n\n\n\n\n\n\n\nname\nage\nsex\nposition\nnationality\n\n\n\n\nJulie\n27\nF\nPhDstudent\nDK\n\n\nThomas\n33\nM\nPostdoc\nGB\n\n\nEmilie\n23\nF\nPhDstudent\nCH\n\n\nSofie\n31\nF\nPostdoc\nDK\n\n\nSara\n29\nF\nPostdoc\nUS\n\n\nCecilie\n34\nF\nPostdoc\nDK\n\n\nAnders\n32\nM\nPhDstudent\nUK\n\n\nEmma\n42\nF\nProfessor\nDK\n\n\nCaroline\n31\nF\nPhDstudent\nDK\n\n\nLaura\n30\nF\nPostdoc\nDK\n\n\nMikkel\n33\nM\nPostdoc\nNL\n\n\nJens\n27\nM\nPhDstudent\nDK\n\n\nAndreas\n29\nM\nPhDstudent\nDK\n\n\nJakob\n28\nM\nPhDstudent\nDK\n\n\nMathilde\n61\nF\nProfessor\nDK\n\n\nKatrine\n35\nF\nPostdoc\nDK\n\n\nPoul\n30\nM\nPostdoc\nDK\n\n\nAnna\n26\nF\nPhDstudent\nDK\n\n\nPeter\n42\nM\nProfessor\nGB\n\n\nIda\n53\nF\nPostdoc\nDK\n\n\nFreja\n30\nF\nPostdoc\nDK\n\n\nMaria\n39\nF\nProfessor\nUK\n\n\nAmalie\n29\nF\nPhDstudent\nDK\n\n\nCamilla\n35\nF\nPostdoc\nDK",
    "crumbs": [
      "Reports",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Markdown in Quarto</span>"
    ]
  },
  {
    "objectID": "reports/example.html#margin-content",
    "href": "reports/example.html#margin-content",
    "title": "Markdown in Quarto",
    "section": "Margin content",
    "text": "Margin content\nYou can anything in the margin like Figure 8.6.\n\n\n\n\n\n\n\n\n\n\n\nFigure 8.6: Figure legends are defined alongside the figure in the notebook. The figure size in the notebook is determines its size when embedded in a document 4x3 inches.",
    "crumbs": [
      "Reports",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Markdown in Quarto</span>"
    ]
  },
  {
    "objectID": "reports/example.html#diagrams",
    "href": "reports/example.html#diagrams",
    "title": "Markdown in Quarto",
    "section": "Diagrams",
    "text": "Diagrams\nDiagram in Figure 8.7.\n\nCode\ngraph G {\n  layout=neato\n  run -- intr;\n  intr -- runbl;\n  runbl -- run;\n  run -- kernel;\n  kernel -- zombie;\n  kernel -- sleep;\n  kernel -- runmem;\n  sleep -- swap;\n  swap -- runswap;\n  runswap -- new;\n  runswap -- runmem;\n  new -- runmem;\n  sleep -- runmem;\n}\n\n\n\n\n\n\n\n\n\n\n\n\nG\n\n\n\nrun\n\nrun\n\n\n\nintr\n\nintr\n\n\n\nrun--intr\n\n\n\n\nkernel\n\nkernel\n\n\n\nrun--kernel\n\n\n\n\nrunbl\n\nrunbl\n\n\n\nintr--runbl\n\n\n\n\nrunbl--run\n\n\n\n\nzombie\n\nzombie\n\n\n\nkernel--zombie\n\n\n\n\nsleep\n\nsleep\n\n\n\nkernel--sleep\n\n\n\n\nrunmem\n\nrunmem\n\n\n\nkernel--runmem\n\n\n\n\nsleep--runmem\n\n\n\n\nswap\n\nswap\n\n\n\nsleep--swap\n\n\n\n\nrunswap\n\nrunswap\n\n\n\nswap--runswap\n\n\n\n\nrunswap--runmem\n\n\n\n\nnew\n\nnew\n\n\n\nrunswap--new\n\n\n\n\nnew--runmem\n\n\n\n\n\n\n\n(a) This is a simple graphviz graph.\n\n\n\n\n\n\n\nFigure 8.7\n\n\n\n\n\nCode\nflowchart LR\n  A[Beginning] --&gt; B[Middle]\n  B --&gt; C[End]\n\n\n\n\n\nflowchart LR\n  A[Beginning] --&gt; B[Middle]\n  B --&gt; C[End]\n\n\n\n\n\n\n\n\n\n\nCode\nflowchart LR\n  A[Beginning] --&gt; B[Middle]\n  B --&gt; C[End]\n\n\n\n\n\nflowchart LR\n  A[Beginning] --&gt; B[Middle]\n  B --&gt; C[End]\n\n\n\n\n\n\nThis is a flow chart.",
    "crumbs": [
      "Reports",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Markdown in Quarto</span>"
    ]
  },
  {
    "objectID": "reports/example.html#code",
    "href": "reports/example.html#code",
    "title": "Markdown in Quarto",
    "section": "Code",
    "text": "Code\nExecuted but hide code and any output:\nShow and execute Python code:\n\n\nCode\nx = 5\n\n\nValues can be embedded in the text, too. The value of x is 5.\nShown, not executed, Python code:\ny = 4\n\n\nA for loop:\nfor i in range(10):\n    print(i)\nShown, not executed, R code:\nz &lt;- 7",
    "crumbs": [
      "Reports",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Markdown in Quarto</span>"
    ]
  },
  {
    "objectID": "reports/example.html#math",
    "href": "reports/example.html#math",
    "title": "Markdown in Quarto",
    "section": "Math",
    "text": "Math\nThis is calculated as \\(\\pi_k = \\prod_{i=1}^K x_i\\). You can crossref formulas (Equation 8.1).\n\\[\n\\lambda = \\sum_{k=1}^N \\pi_k\n\\tag{8.1}\\]\n\n\nWe know from the first fundamental theorem of calculus that for \\(x\\) in \\([a, b]\\):\n\\[\\frac{d}{dx}\\left( \\int_{a}^{x} f(u)\\,du\\right)=f(x).\\]",
    "crumbs": [
      "Reports",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Markdown in Quarto</span>"
    ]
  },
  {
    "objectID": "reports/example.html#bold-and-italics",
    "href": "reports/example.html#bold-and-italics",
    "title": "Markdown in Quarto",
    "section": "Bold and italics",
    "text": "Bold and italics\nThis is bold, so is this. This is italics, so is this. This is both, so is this.",
    "crumbs": [
      "Reports",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Markdown in Quarto</span>"
    ]
  },
  {
    "objectID": "reports/example.html#section",
    "href": "reports/example.html#section",
    "title": "Markdown in Quarto",
    "section": "Section",
    "text": "Section\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Duis sagittis posuere ligula sit amet lacinia. Duis dignissim pellentesque magna, rhoncus congue sapien finibus mollis. Ut eu sem laoreet, vehicula ipsum in, convallis erat. Vestibulum magna sem, blandit pulvinar augue sit amet, auctor malesuada sapien. Nullam faucibus leo eget eros hendrerit, non laoreet ipsum lacinia. Curabitur cursus diam elit, non tempus ante volutpat a. Quisque hendrerit blandit purus non fringilla. Integer sit amet elit viverra ante dapibus semper. Vestibulum viverra rutrum enim, at luctus enim posuere eu. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus.\n\nSubsection\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Duis sagittis posuere ligula sit amet lacinia. Duis dignissim pellentesque magna, rhoncus congue sapien finibus mollis. Ut eu sem laoreet, vehicula ipsum in, convallis erat. Vestibulum magna sem, blandit pulvinar augue sit amet, auctor malesuada sapien. Nullam faucibus leo eget eros hendrerit, non laoreet ipsum lacinia. Curabitur cursus diam elit, non tempus ante volutpat a. Quisque hendrerit blandit purus non fringilla. Integer sit amet elit viverra ante dapibus semper. Vestibulum viverra rutrum enim, at luctus enim posuere eu. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus.\n\n\nSubsubsection\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Duis sagittis posuere ligula sit amet lacinia. Duis dignissim pellentesque magna, rhoncus congue sapien finibus mollis. Ut eu sem laoreet, vehicula ipsum in, convallis erat. Vestibulum magna sem, blandit pulvinar augue sit amet, auctor malesuada sapien. Nullam faucibus leo eget eros hendrerit, non laoreet ipsum lacinia. Curabitur cursus diam elit, non tempus ante volutpat a. Quisque hendrerit blandit purus non fringilla. Integer sit amet elit viverra ante dapibus semper. Vestibulum viverra rutrum enim, at luctus enim posuere eu. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus.\n\n\n\n\nDutheil, Julien Y, Kasper Munch, Kiwoong Nam, Thomas Mailund, and Mikkel H Schierup. 2015. “Strong Selective Sweeps on the X Chromosome in the Human-Chimpanzee Ancestor Explain Its Low Divergence.” PLOS Genetics 11 (8): e1005451. https://doi.org/10.1371/journal.pgen.1005451.\n\n\nMunch, Kasper, Thomas Mailund, Julien Y Dutheil, and Mikkel Schierup. 2014. “A fine-scale recombination map of the human–chimpanzee ancestor reveals faster change in humans than in chimpanzees and a strong impact of GC-biased gene conversion.” Genome Research 24 (3): 467–74. https://doi.org/10.1101/gr.158469.113.\n\n\nNam, Kiwoong, Kasper Munch, Asger Hobolth, Julien Dutheil, Krishna R Veeramah, August E Woerner, Michael F Hammer, et al. 2015. “Extreme selective sweeps independently targeted the X chromosomes of the great apes.” Proceedings of the National Academy of Sciences 112 (20): 6413–18. https://doi.org/10.1073/pnas.1419306112.\n\n\nNielsen, Rasmgb, and Montgomery Slatkin. 2016. An Introduction to Population Genetics: Theory and Applications.\n\n\nPrüfer, Kay, Kasper Munch, Ines Hellmann, Keiko Akagi, Jason R. Miller, Brian Walenz, Sergey Koren, et al. 2012. “The bonobo genome compared with the chimpanzee and human genomes.” Nature 486 (7404): 527–31. https://doi.org/10.1038/nature11128.\n\n\nSkov, Laurits, Moisès Coll Macià, Elise Anne Lucotte, Maria Izabel Alvez Cavassim, David Castellano, Mikkel Heide Schierup, and Kasper Munch. 2023. “Extraordinary selection on the human X chromosome associated with archaic admixture.” Cell Genomics, 100274. https://doi.org/10.1016/j.xgen.2023.100274.",
    "crumbs": [
      "Reports",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Markdown in Quarto</span>"
    ]
  }
]